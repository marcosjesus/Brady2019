Q.  How do I create a group band at runtime?
A.  You can call the band's constructor and set it's 
properties.
  with TQRGroup.Create(Self) do
  begin
    Parent := QuickRep1;
    Master := Parent;
    Expression := 'CustNo';
  end;

  Add a control like this,
  with TQRDBText.Create(Self) do
  begin
    Parent := QRGroup1;
    Dataset := QuickRep1.Dataset;
    DataField := 'CustNo';
  end
------------------
Q. Trying to call addprintable in the beforeprint event of a band causes an Access Violation. Is this not allowed for some reason?
A.  You can only call AddPrintable or otherwise add a control to a report band before you start the report.  QuickReport needs to know about all printable controls before it starts the report.
------------------
Q.  I am generating report at run time and I have a question: If for example I set QuickReport.HasTitle as true it automatically creates the title band. The problem is that I won't be able to know the name of title variable that was created.
A.  You can reference it through the report's bands property like with the following example:

    with QuickRep1 do
    begin
      ReportTitle := 'Sample Report';
      Bands.HasTitle := true;
      with TQRSysData(Bands.TitleBand.AddPrintable(TQRSysData)) do
      begin
         Data := qrsReportTitle;
         AlignToBand := true;
         Alignment := taCenter;
      end;

      Preview;
    end;

This adds a titleband with the report's title centered on the band.  You will need to add the quickrpt and qrctrls units to the use list in the unit that has this code.

You can reference each band type that can be set through the HasXXXXX properties from the following list:
TitleBand
PageHeaderBand
ColumnHeaderBand
DetailBand
PageFooterBand
SummaryBand
------------------
Q.  If you use the method AddPrintable, how can you access the control that was created?
A.  Just assign the control created by AddPrintable to a variable of that type of control.  You can then change the top and left properties by referencing that variable.
Example:

var
  MyCtrl : TQRSysdata;
  .....
  MyCtrl := TQRSysData(Bands.TitleBand.AddPrintable(TQRSysData));
  with MyCtrl do
  begin
     Data := qrsReportTitle;
     AlignToBand := true;
     Alignment := taCenter;
  end;
------------------

[Bands]
==================
Q.  I'm having problems printing memos on bands with AlignToBottom set to true.
A.  Bands with AlignToBottom set to true must be a fixed height, you can't have stretching controls on them.  QuickReport needs to know the length of bands that will be at the bottom of the page so that it keeps enough room for them.
------------------
Q.  I am using the QRStringsBand in a multiple column report with a Column Header band.  The Column Header band does not print for the first column.
A.  The QRStringsBand can not be used with other bands, it will not work the way you would expect it to.  The ColumnHeaderBand band was designed to work with detail bands and the printing will not be correctly synchronized with the QRStringsBand.  The only work around is to use the detail band and the OnNeedData event or use the Abstract table, instead of the QRStringsBand
------------------
Q.  How can I print a band a specific location on the page?
A.  The current band's printing position is set by the report's CurrentY property.  This is an integer property and each unit represents 1/10 mm, (254 = 1 inch).  The report automatically updates this property, but you can override it in the band's BeforePrint event to position the band at a specific location.
------------------
Q.  How can I put 3 title bands in a report and enabled/disabled them depending some condition?
A.  You can only have one title band per report.  You can add child bands to the title band and enable/disable each band in code.
------------------
Q.  My report goes out of control when I have child bands attached to the page header.
A.  You can not have a page header where the height (including all child bands ) is greater than a page.  This is not supported.  When the page header prints, the child bands that belong to the page header will be printed.  If one of the child bands doesn't fit on the page, it will cause a page break and the page header print code will be called again.  This will put the page header code in a recursive loop until the computer runs out of disk space or memory.
------------------
Q.  I just added a new subdetail band and it's at the bottom of the report.  How do I put it in the correct location?
A.  The band order is determined by the band type, it's master property, and it's creation order.  If the master property is blank, then the band will be placed at the bottom of the report.  If the subdetail band "belongs" to the detail band, then the master property should be set to the report.  If it belongs to another subdetail band, set the master property to that band
------------------
Q.  I just added a subdetail band to a report that already has a couple of subdetail bands.  How can I put the new band above the other ones?
A.  If you are trying the subdetail band before another one that has the same value for the master property, the safest way to do this is to view the form as text and cut and the paste the band to the location that you want.  The band order is determined by the band type, it's master property, and it's creation order.
------------------
Q.  Why does GroupHeader (or Detail) band's BeforePrint event executes before than PageHeader band's BeforePrint event?
A.  When the GroupHeader (or Detail) band's BeforePrint event has executed, the report is still on the previous page.  After it processes the BeforePrint, it checks to see if the band will fit on the page.  If it doesn't fit, a new page is generated and the PageHeader BeforePrint event is called.  You can suppress the band from printing with the BeforePrint event, that is why it doesn't do a new page until after the BeforePrint event has run.
------------------
Q.  I would like to have a blank row every fifth line.  Is there an example on how to do this?
A.  A simple way to this is to add a childband to the detailband.  In the ChildBand's BeforePrint event, set the PrintBand variable that is passed in the event to true every 5th band and false the rest of the time.
Example:
procedure TfrmBands.ChildBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  PrintBand := (TQuickRep(Sender.Parent).RecordNumber mod 5) = 0;
end;
------------------
Q.  My ColumnHeader bands are not printing when there isn't any data for the report
A.  You must have at least one detail band printed to print a column header band.
------------------
Q.  I have a childband and I set it's PrintBand to false based on certain conditions.  When the band doesn't print, QuickReport doesn't check this and will generate a new page is this band would have been the last band on page.
A.  QuickReport checks the space required for the next band before the BeforePrint event of that band is processed.  There is a simple work around that will resolve this issue.  In the BeforePrint event of the previous band (in this case, the detail band), set the height of the child band to 0.  You could store the height of the child band in it's Tag property at the same time.  In the BeforePrint event of the ChildBand, you would set the height back to original height when you have set PrintBand to True.
------------------
Q.  How can I create a report with a Title band to print ABOVE the Page Header band?
A.  The print order of the bands is fixed, you can not print a title band above the page header.  One work around would be to use a child band with the page header.  Put the page header information on the child band and place the title information on the actual page header band.  In the Page Header band's BeforePrint event, set PrintBand to false when the report's PageNumber property is greater than 1.
------------------
Q.  How do I get the column header for to print right above the detail band when I also have a group band?
A.  ColumnBands always printed at the top (after the title and pageheader bands).  There are a couple of ways of doing what you are looking for.  You could either put the column labels on the group band or on a child band attached to the group band.
------------------
Q.  Is there a way to print a band as footer only on the last page of a report.
A.  Instead of using a footer band, use a summary band and set it's AlignToBottom property to true.
------------------
Q.  How do I disable the detail band so that I can calculate in the detail section without printing it?  I just want the summary band to print.
A.  set the height of the band to 0 when you want to suppress it and still use it for functions.  Just remember to set the height back to the design time height when you do want to print the band.
------------------
Q.  How can I add a child band at runtime and fields to it?
A.  The way to create a child band is to set the HasChild property of 
the parent to true.  The following code creates a child band and then 
adds a QRLabel control to the child band

  QRGroup1.HasChild := true;
  with TQRLabel(QRGRoup1.ChildBand.AddPrintable(TQRLabel)) do
  begin
    Left := 0;
    Top := 0;
    Caption := 'Hello there';
  end;

Q.  Is there any possibility to extract the fields embedded in a specific band during run-time?
A.  The bands are descended from TCustomPanel and you can use the ControlCount property to loop through all of the controls on the band.
For example:

with PageHeaderBand1 do
  for nIdx := 0 to ControlCount -1 do
    if Controls[nIdx] is TQRLabel then
      TQRLabel(Controls[nIdx]).Caption := IntToStr(nIdx);
------------------
Q.  How do I reference the name of a childband created at runtime by setting a band's HasChild property to true?
A.  You must create the Childbands before the report starts.  All QuickReport bands and controls must exist before the report starts.  The easiest way to create a childband is the set the HasChild Property of the parent band to true.  You can reference the child band through the Parent band's ChildBand property.  The childband will have a blank name property, but you can set that at runtime.  The following example shows how to create a childband, add a label to it, and then get the name of that band:
procedure TfrmReport.FormCreate(Sender: TObject);
var
  MyChild: TQRChildBand;
begin
  QRGroup1.HasChild := true;
  with TQRLabel(QRGRoup1.ChildBand.AddPrintable(TQRLabel)) do
  begin
    Left := 0;
    Top := 0;
    Caption := 'Hello there';
  end;
  MyChild := QRGRoup1.ChildBand.Name;
end;
------------------
Q.  How do I check the height of a band with stretching controls at runtime?
A.  Use the ExpandedHeight method of the band.
------------------
Q.  Is it possible to have 2 or more PageHeader Bands in same Report ?
A.  You can not have multiple PageHeader bands on a report, but there are ways to resolve this.  The simplest way would be to add a child band to the page header and put the fields on the child band that would be used for the 2nd page header.  You would then use the BeforePrint event of the page header and of it's child to decide at run time which band to print.
------------------
Q.  I have a detail band with a child band.  I want to change the number and layout of the controls on the child band at runtime, but I get an exception error when I add new controls while the report is running.
A.  All bands and the controls on the bands must be created before the report starts, otherwise you will get the exception that you reported.

There are a couple of ways of doing this.  One way is to have multiple child bands, each one with a different layout to fit your needs.  At run-time, you control which child bands can be output.  Just use the BeforePrint event and set the PrintBand variable to false for the ones that you do not want to print.

If you only want one band, put all of the controls on it. and at run time hide the ones that you do not need by setting their Enabled property to false.  
------------------
Q.  I have a report that has about 10 child bands that may or may not get printed depending on run time criteria. This report always prints two pages, even if it only needs one to accommodate the Childbands allowed at run time. Is there a workaround for this?
A.  In the report's form create event, set each childband's tag property to it's height value and then set the height to 0.  Whenever you set printband to true in the BeforePrint event of a band, set the band's height to the it's tag value.  In the AfterPrint event, set the height back to zero again.
------------------

[Barcodes]
==================
Q.  Where can I get a barcode component to use with QuickReport?
A.  We do not provide a barcode control, but on our download page, there are some links to companies who do barcode controls for QuickReport.
------------------
Q.  Where can I find a barcode font that I can use with QuickReport?
A.  There are many companies that have barcode fonts, here are a few of them:
CIA (Bar Codes), Wythenshawe, Manchester, UK   http://ourworld.compuserve.com/homepages/CIA_UK
Rivers Edge, Cedar Park, TX, USA               http://www.riversedge.com
Azalea, Seattle, WA, USA                       http://www.azalea.com
------------------

[C++Builder]
==================
Q.  I can not find any of the C++ source code files to QuickReport.
A.  QuickReport is written entirely in Delphi, there are no C++ files in the package.  C++Builder has the ability to compile Delphi files directly to .obj and .hpp files.
------------------
Q.  I get an access violation if set the detail band's ForceNewPage property to true at runtime.
A.  This can happen if you smart linking enabled.  You can either turn off the smart linking or set the property at design time.
------------------
Q.  I am trying to use QuickReport with C++Builder, but your documentation and examples are all Delphi based.
A.  QuickReport is primarily a Delphi product, we do not have the resources to provide the same level of support to the C++Builder users as we can for Delphi users.
------------------

[Composite Reports and multiple dataset reporting]
==================================================
Q.  I have a TQRCompositeReport, with two TQuickReps.  The First TQuickRep is a single column report.  The second is a three column report.  It should print on one page (first report about 2/3 page, second report last 1/3).  The first column of the second report prints fine. The second column starts at the top of the page, and overwrites data from the first report.
A.  You can't mix single and multiple column reports in the CompositeReport, it's not supported.  The only way you can do this is to force a newpage at the start of each report.
------------------
Q.  How do I make a MDI custom preview that supports the CompositeReport?
A.  Custom Previews for CompositeReports can be done in the Delphi version of QuickReport 3.  There is a QR3 MDI demo project on our download page.  Due to language differences, this functionality is not available for C++Builder.
------------------
Q.  I have an application that saves a series of reports to the QRP format.  I would like to print them all at once as a single print job, is that posible?
A.  In the QR3RNGD4.ZIP project on our download page, we have a function named CombineQRP() in the qrqrp.pas unit.  The function takes a stringlist of QRP filenames and combines them into a single QRP file.  You can then load that file into a preview or the TQRPHandler class for viewing or printing.  This can be used as an alternative to the CompositeReport.
------------------
Q.  What are the steps to load reports and preview composite reports.  I add reports to the TList property of QRComposite and then call preview and the preview is empty.
A.  You must add the reports in the TQRCompositeReport's OnAddReports event or they will not be picked up.
Example:
procedure TMainForm.QRCompositeReport1AddReports(Sender: TObject);
begin
  with QRCompositeReport1 do
  begin
    Reports.Add(ListForm.QuickRep);
    Reports.Add(GrpListForm.QuickRep);
    Reports.Add(MDForm.QuickRep);
    Reports.Add(ManyGrpForm.QuickRep);
  end;
end;
------------------
Q.  How can we save a composite report to a file (*.QRP) from source code?  (We can not access a QRPrinter object for Composite Report (seems to be declared 'private')).
A.  You should be able access the qrprinter by referencing the qrprinter of one of the individual reports in the composite report after you call Prepare.
------------------
Q.  Is there a way to set it up so that each individual report making up the composite starts on a new page when that portion goes to print?
A.  To get the second (or 3rd...) report to start on a new page, make sure that 2nd report has a title band and in the title band's BeforePrint event, call the NewPage method of the second report.  If this report is used outside of the composite report, you will need to disable that code.
------------------
Q.  I wish to create a report which lists the contents of two unrelated tables. How do I do this if you can only have one detail band per report?
A.  Use multiple subdetail bands, one for each table.  Set their Master property to the report.  You don't need a detail band, but you will need to set the PrintIfEmpty property of the report to true.  Each subdetail band can have nested subdetail bands and group header and footer bands.
------------------
Q.  One of the reports in my Composite Report has Landscape Orientation, and the others are Portrait. The report prints everything in Portrait
A.  You can not mix landscape and portrait oriented reports with the composite report.
------------------
Q.  I'm currently using QuickReports for printing static forms without any report functionality. This works fine for me. Then I try to print multiple forms (multiple TQuickReps) as one print job. Therefore I´m using the TQRCompositeReport component but if there are no report components on the TQuickReps nothings happens if you try to print or preview. Is there a way to print different static forms as one print job ?
A.  The CompositeReport control requires that the reports have their controls on report bands.  I was able to print two static reports in a composite report by using a detail band size to fit the page and with the report's PrintIfEmpty set to true.
------------------
Q.  In a report I need just to apply a new filter to the qreport dataset and then continue the report.  It's like running several reports but "bundled" all together in one preview / report.
A.  You can not change the filter on an open dataset, that's a BDE limitation.  One way to do this would be to use multiple subdetail bands for each band.  Each band could use the same dataset.  You would add a group footer band to each dataset.  You would close it, change the filter, and the reopen it in the group footer band of the PREVIOUS dataset.
------------------

[Datasets]
==================

Q.  I cannot find information about Options Property for TQuickRep
A.  The first options (FirstPageHeader, LastPageFooter) are self describing.  If the FirstPageHeader is set to false, then the page header will not be printed on the first page.  LastPageFooter works in a similar manner  If the Compression property is set to true, then a simple compression routine is used on the internal metafile storage of a rendered report.
------------------
Q.  How does the OnPrint event work?
A.  The OnPrint event is called just before the control is printed. The string to be outputted is in the Value property and can be changed. This property is also useful to suppress printing of repeated values.  This event only gets called at runtime, the design time preview will not call any of the event handlers.
------------------
Q.  How do I install the help files into Delphi 3's integrated help?
A.  1. Copy the file QUICKRPT.HLP  into the HELP directory under the Delphi 3 main directory.
2. Add the line
:Link quickrpt.hlp
to the "Third-Party Help" section at the bottom of the DELPHIX.CFG file  located in the Delphi HELP directory.
3. Delete the hidden file DelphiX.GID in the HELP directory.

The next time you launch the Delphi help, it will rebuild the delphiX.gid file and the QuickReport help file will be in the integrated help.  Please note that this help file is not complete and will not have support for all controls.  This will addressed in the 3.0 release.
------------------

[Exporting reports]
==================
Q.  When I exports report to Excel file, Why does the PageHeaderBand's content exported once only, How can I export the PageHeader once per page?
A.  The XLS filter is designed to run as a single page and the Page Header and Page Footer bands will only print once.
------------------
Q.  Can I export only the detail band (instead of the whole report)?  I also want to export fields that would not show up in the preview.
A.  The report has property named Exporting and it set to true when you are exporting a report.  At runtime, you can enable or disable bands and text components based on the value of Exporting in the report's BeforePrint event.
------------------
Q.  How can I export files to the EMF format?
A.  Set the Enhanced property of the TQRWMFFilter component to true and EMF files will be exported instead of WMF.
------------------
Q.  I have a report that uses queries that take a long time to execute.  I tried using the Prepare method so the report would not have to be rendered again when the user prints.  This is keeping the user from exporting the report,  How can I let the user export the report with out having to runt he queries all over again?
A.  Quickreport can only export reports when they are being generated.  When you call Prepare, the report is written to a linked list of metafiles.  There is no way to take the data out of the metafile and export to another format.
One alternative method would be to query the data to a temporary table (or set of tables) and use that table for the report.  That way you will only have to run the queries once.
------------------
Q.  What is the best way to import pages from a report into a PowerPoint slide show?
A.  Is you use the WMF export filter, PowerPoint can import the files with all of the formatting intact.
------------------
Q.  Could you please tell me how to save a report with a qrp extension instead of printing or previewing it
A.  You would call the report's prepare method to create the report.  Then use the report's qrprinter.save method to save the file, and finally free the qrprinter object of the report.
Example:
    quickrep1.Prepare;
    quickrep1.qrprinter.Save('c:\report.qrp');
    quickrep1.qrprinter.Free;
    quickrep1.qrprinter := nil;
------------------
Q.  I am writing a printable component for QuickReport (using C++ Builder) to display a schedule.  I was wondering what needs to be done to make the printable component have the ability to export to the various export filters.  Currently when I try to export to any filter other than wmf it exports to a blank file.
A.  You would need to add code in your component's Print method that checks the report's Exporting property and call the report's ExportFilter->TextOut() function with the text to be printed.  All of our code is in Delphi, but you should be able to do this with BCB3.  In the source code for the qrctrls.pas unit, look at the PrintLine procedure, it show how we pass the text to the export filter for our standard text components.
------------------
Q.  Is there any way to combine QRP files into a single QRP?
A.  There is a demo project on our download page named QR3RNGD4.ZIP and it has a unit named qrqrp.pas.  That unit contains a function named CombineQRP() for combining multiple QRP files ((as long as they all use the same page size and orientation)) to a single QRP file.  You just pass in the new file name and a stringlist of existing QRP files, and it combines them.
------------------
Q.  How do I call the Quick Report export filters outside of the preview?
A.  To call a filter explicitly you would use syntax like:

aFilt : TQRXLSFilter;

aFilt := TQRXLSFilter.Create('c:\report.xls')
quickrep1.ExportToFilter(aFilt);
aFilt.Free;

Other filters:
HTML: TQRGHTMLDocumentFilter
ASCII: TQRAsciiExportFilter
CSV: TQRCommaSeparatedFilter
RTF: TQRRTFExportFilter
WMF: TQRWMFExportFilter
PDF: TQRPDFDocumentFilter
------------------
Q.  The output from RTF export filter looks odd when loaded into a TRichEdit control.  If I load it into Word 97, it looks more like the report.
A.  The RTF export filter was written to the MS RTF specification, version 1.5.  I am not familiar with a control named TRichTextBox, but the files generated by this filter can be read by TRichEdit.  TRichEdit does not fully support the RTF command sequence and it will not display RTF files with same accuracy as MS Word.  For example, TRichEdit does not support right alignment.
------------------
Q.  The output from the export filters does not match the preview's layout.
A.  The export filter layout is a best fit approximation.  You are taking controls that can be arranged anywhere on a band and sending them to a format that is not as flexible.  You can get better results for the filters by changing the layout of the fields and/or their font property.  The report has a boolean property, Exporting, that will be set to true when an export filter is running.  You can add code in the BeforePrint event of the report to check this property if you want to make changes that would only take affect when exporting a report.  If you are using proportional spaced fonts, the layout from the ASCII export filter is going to be a poor match.  You will want to use a mono spaced font like Courier New instead of Arial for the controls.   You could also set the font's Pitch to fpFixed and let Windows substitute the font for you.
------------------
Q.  How do I use the WMF export filter outside of the preview?
A.  The WMF export filter works differently than the other filters.  The other export filters render the report using the filter.  The WMF filter takes the pages rendered to the preview and saves each page as a metafile.  To use this filter outside of the preview, you have to render the report first using Prepare.
Example:
    quickrep1.Prepare;
    quickrep1.qrprinter.ExportToFilter(TQRWMFExportFilter.Create('c:\report'));
    quickrep1.qrprinter.Free;
    quickrep1.qrprinter := nil;
Please note that the file named extension is picked by the Enhanced property to the export filter.  EMF if it's True, WMF if it's false.
------------------
Q.  I want to change the layout of the report when it is being saved with export filter, is there a way to determine when a report is being exported?
A.  When an export filter is being used, the report's Exporting property will be set to true.  Some of the current export filters have problems lining up columns when the column header's controls have a different alignment than the controls on the detail band.  You can check the Exported property in the report's BeforePrint event and change the appearance of the controls based on that value.
------------------
Q.  When I try to export a previously saved report (a .QRP file), nothing happens.
A.  Quickreport can only export reports when they are being generated.  The .QRP saved file consists of a list of metafiles, one for each page.  There is no way to take the data out of the metafile and export to another format.
------------------
Q.  How do I get all of the export filters to show in the save dialog in my preview?
A.  Just drop the export filter components on the main form of your application.
------------------
Q.  How do I use the HTML export filter?
A.  The HTML filter is an add-on and you will need to add and QRWebfilt to your uses clause 

HTML: TQRGHTMLDocumentFilter;

HTML := TQRGHTMLDocumentFilter.Create('c:\report.html')
quickrep1.ExportToFilter(HTML);
HTML.Free;

------------------

[Expressions and user functions]
==================
Q.  I don't assign the dataset to the report's dataset property (for single record reports), none of the expressions work.
A.  The report will only "know" about reports that are assigned to it's dataset property or the dataset property of a subdetail band.  At runtime, you can add the dataset to the AllDataSets list in the report's BeforePrint event.
Example:
procedure TForm2.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
begin
  with quickrep1.AllDataSets do
    if IndexOf(Form1.tbCountry) = -1 then
      Add(Form1.tbCountry);
end;
------------------
Q.  I lose the decimal points when I an expression like Orders.SubTotal*15
A.  Multiplying a floating number by an integer in the expression will produce an integer.  If you change the 15 to 15.0, you will get an floating point result.
------------------
Q.  How can I use the SUM() expression to sum together 2 fields from two subdetail bands?
A.  No, you can not do this with the QRExpr expression controls.  The QRExpr component has a master property that gets set to the report or to a subdetail, you can't set the Master to multiple items.  You would have to calculate the sum in code and assign the value to a QRLabel component.
------------------
Q.  I am trying to write code as below to retrieve the Function Expressions from a report.
for (int i = 0; i < Rpt->Functions->Count; i++) {
  /*fFunctions is a StringList*/
  fFunctions->Add(Rpt->Functions-><SomeProperty>);
}
I was able to retrieve the function names but I cannot figure out where you store the function Expressions. How do I read a Function to obtain the function expresion?
A.  Functions are not a TStringlist, they are descendant of the TStringlist, augmented to store the expression data structures.  The expressions are stored as a TQREvEmbeddedFunction class object in the Objects list of the Functions class.  If you look at the TQREvEnvironment.AddFunction procedure in qrexpr.pas, you can see how we store the function.  That should give you enough information to be able to access the data.

In Delphi, the following code would retrieve the expression.
vars....
  rpt: TQuickRep;
  TheName,
  TheExpression: string;
  func: TQREvEmbeddedFunction;
  i : integer;

Code....
  TheName := 'foo';
  rpt.Functions.AddFunction(TheName, 'bar');
  i := rpt.Functions.IndexOf(TheName);
  if i >= 0 then begin
    func := TQREvEmbeddedFunction(rpt.Functions.Objects[i]);
    TheExpression :=  func.Expression;
  end;
------------------
Q.  I have been trying to use a summed expression in the summary band to calculate percentages in the detail band without success.  I am trying to calculate and print each customer sales as a percentage of the the total sales for the report
A.  You will not be able to do that unless you have the total first.  The detail band prints as it reaches each record in the dataset, the total is not known until you have reached all of the records.  You could do this by using a TQuery that just returned the total and use that field in your expression.
------------------
Q.  Fields that have a period in the fieldname that are placed on a report via the QuickReport Wizard results in "Unknown function".
A.  This is an open issue and the workaround is: Via the Object Inspector, go into the Expression Wizard and select the field so you have "Table1.F_ADT1.F_CHARL1" instead of "[F_ADT1.F_CHARL1] ".
------------------
Q.  I tried changing the expression property of a TQRExpr component in the BeforePrint event of the detail band but it did not work.
A.  The Expression property of the TQRExpr and TQRGroup components is read only the beginning of the report and can not be changed while the report is running.  You can use the OnPrint event to override the output of the TQRExpr component.
------------------
Q.  How can we Round Off a number, like to 2 decimal places?
A.  We do not have a rounding function, but this is easy to emulate.  Add 0.05 to the value, then multiply the value by 100, use the INT() function to truncate the decimal point, then divide by 100.0
------------------
Q.  Can I test for multiple conditions with the SUM() function?
A.  You would need to wrap the expressions in parenthesis like: SUM(IF(((PayType1='C') And (PayType2='N')), tPayments.PayValue,0.0))
------------------
Q.  How can I do an IF() function for a field that has single quotes around it?
A.  At design time you would enter into the Object inspector something like: IF(MyField=''SomeValueInSINGLEQuotes'', 1, 0)
In code you would syntax like QRExpr.Expression := 'IF(MyField='#39#39'SomeValueInSINGLEQuotes'#39#39', 1, 0)';
------------------
Q.  I have a report with a TQRGroup,a DetailBand and a GroupFooter band. I want to sum certain values in the GroupFooter for each Group. The problem is that it doesn't sum within the group. It just keeps increasing the values until the end of the report. I don't get the sum for each group.
A.  You will need to set the ResetAfterPrint property to true for the TQRExpr control that you are using on the GroupFooter.
------------------
Q.  I am trying use the SUM() function inside the IF() function to do a conditional sum, but the control just prints the expression text.  My expression is IF(Table1.PUR_PRICE>40, SUM(Table1.PUR_PRICE), '').
A.  YOU are missing the 3rd parameter to the IF function and all three parameters are required.  Try using an blank string ('') as the 3rd parameter.
Example: SUM(IF(COPY(Table1.pos,1,1)='M',table1.Price,0.0))
This would sum the table1.Price field for the current record if the Table1.pos starts with the letter "M".  If the Table1.pos field did not start with "M", that record would not be included in the SUM() function.
------------------
Q.  I would like to summarize the number of times a non numeric value repeats in a table (without making a new sqlquery like "select count(xxx) where xxx = 'yyy')
A.  You can embed functions in other functions.  You can use the IF() function in the SUM() function to sum the number of times a value appears in the dataset.  The following expression will return the number of records where the state = 'HI',  SUM(IF(Customers.State='HI', 1, 0))
------------------
Q.  With the TQRExpr control, the expression -3*4 evaluates to 12 instead of -12
A.  This is bug in QuickReport 2 (fixed in QuickReport 3) and the work around would be to use the expression (0-3)*4, which will give the correct value.
------------------
Q.  When I create a report from the Delphi menu (File/New/Report), the QRExpr control does not find all of the datasets on that report.
A.  When the report is not on a form, QRExpr controls will not pick datasets that are connected to the report unless you manually add them at runtime using AllDataSets.  When the report is on a form, QRExpr will find the datasets on that form automatic.  This is also applicable for the expression property of the TQRGroup band.
------------------
Q.  I am using a TQRExpr to print the SUM of a field of a Query.  But I have a problem. If the Query has no result (zero records) then instead of printing the number 0, It is printing SUM(qry.Total).
A.  This is a known problem with QR2 and the work around is to use the OnPrint event of the TQRExpr control to blank out or zero out the value when the value is equal to the expression like the following example:

procedure TfrmReport.QRExpr1Print(sender: TObject; var Value: String);
begin
  if sender is TQRExpr then
    if Value = TQRExpr(sender).Expression then
      Value := '0.0';
end;
(QR3) This has been fixed with QuickReport 3
------------------
Q.  When I add lines to a QRExprMemo control at runtime, the control does not filter out any blank lines that may have added.
A.  This control filters out blank lines when the lines are defined before the report starts.  When you add blank lines in the BeforePrint event, we assume that you actually want them in the memo.  The work around is to add code to the BeforePrint event so that you are not adding blank lines at runtime.
------------------
Q.  How do you use the FORMATNUMERIC function, I can't find a help files to help me?
A.  This function is a wrapper for Delphi's FormatFloat() function.
------------------
Q.  Is there an expression that will permit grouping by month? The underlying database has a date field.
A.  You have to pass in an expression that would be the month, the easiest way is to use a calculated database field that would be the year and the month (unless you want the same month from multiple years grouped together.
------------------
Q.  I want to have a database field as the expression, but the table is not available to me at design time and adding <tablename>.<fieldname> to the expression string at run time doesn't work.
A.  To define an expression at runtime, you must define it before the report starts.  Group bands initialize their expression at the start of the report and you can not change the expression while the report is running.  This limitation will be removed in a future release.
------------------
Q.  I couldn't find any information for the meaning of the "arguments" parameter in the RegisterQRFunction
A.  The last parameter is used for the expression builder to know what
    group to put the function in and what parameters to accept.
    First is the group (1-6), followed by one character for each
    parameter.

    1NN would be in the first group (don't remember which one), with two
    numeric arguments.

    2SNB would be in the second group, three parameters (text,  numeric
    and boolean
------------------
Q.  Expression wont work if the field name has a space or a hyphen in it
A.  The expression parser will not work with field names with spaces or hyphens in it.  This is a limitation that we try to fix in a future release.  There are a few simple workarounds for this.  One way is to use a TQuery control and rename the field name in the SQL statement.  If you have to use a TTable, create a calculated field based that equals the original.
(QR3) With Quick Report 3, you can use fields with spaces in TQRExpr expressions if the field is enclosed in square brackets like '[Table1.Field 1]'.
------------------
Q.  My function doesn't work  I want to use:
if (table1.field1 = '', 'Blank', table1.field1)
to output the text "blank" when the field is blank or null
A.  Change "if (" to "if(" and the function will work.
------------------
Q.  I can't sum TTimeFields?
A.  TTimefields get converted to strings by the expression evaluator which prevents the report from doing
    math operations on it.  A future release will have a a function to 'convert back' to a float.
------------------
Q.  Expressions are being evaluated from right to left
A.  This will be addressed in a later release. The work around is to use parentheses
------------------
Q.  The following expression always returns 0: SUM(IF(Query1.CartonID='SI', Query1.Caliper, 0))
A.  Change the 0 to 0.0 and the SUM() function will work correctly.
------------------
Q.  Why doesn't the expression Count(Table1.Field1) return the right value?
A.  The Count function in the expression builder returns a number that increments by 1 with every call to Count.  It does not behave like the SQL Count() function that counts the variable passed to the function.  If you click on Count in the expression builder you should see "Increments for each iteration" appear under the Count label as the function's description.
-----------
Q.  How do I check the value of QRExpr control at runtime?
A.  The "Value" property of a TQRExpr component is of type TQREvResult, which is defined in qrprntr.pas.  You can check "Value.Kind" to see what the datatype is.  The following table shows how to retrieve the results of the expression based on the value of "Value.Kind"
    If Value.Kind = resInt then the results of the expression are in Value.IntResult
    If Value.Kind = resDouble then the results of the expression are in Value.DblResult
    If Value.Kind = resString then the results of the expression are in Value.StrResult (defined as string[255])
    If Value.Kind = resBool then the results of the expression are in Value.BooResult
    If Value.Kind = resError then the expression had an error
------------------
Q.  I use QRExpr to calculate the Average of a currency field but it shows as numerical, not currency.
A.  This is a known limitation of the QRExpr control.  You can have the control display the currency character by using the mask property and set the mask to something like '$,###.00'.  The QRExpr control's mask is the format string used by FormatFloat() and FormatDateTime functions.  Please refer to their documentation for allowable values.
------------------
Q.  I have a simple query that uses the SQL COUNT(*) and I am  trying to display it in a QRExpr component but it is not displaying that field.
A.  The SQL COUNT(*) is conflicting with the QR COUNT function.  You will have to alias the column or use a QRDBText to output the field.
------------------
Q.  I can't get the QRExprMemo to display more than 255 characters when I use Delphi 1.
A.  The number of characters in a QRExprMemo is limited to the maximum string size.  In Delphi 1, the maximum string length is 255 characters.
------------------
Q.  How can I count frequencies of the values in a dataset field?
A.  You can do this with expressions like:
SUM(IF(Table1.GENDER = 'M', 1, 0)) and SUM(IF(Table1.GENDER = 'F', 1, 0))
------------------
Q.  How can I get the dataset of the report to display in the QRExpression if the dataset is on a separate form?
A.  You will need to add the dataset to the report, using the report's AllDataSets property.  The expression will not work at design time, but it will work at runtime.

Example:

Form1 has a dataset named tbCountry with the field 'Capital' in the table.
Form2 has a report named QuickRep1 with a qrexpr control on the summary band.

You want qrexpr to read the capital field of the tbCountry dataset.

You would have form2 use form1 and in the report's BeforePrint event you would add the tbcountry table to the report with the following syntax:

procedure TForm2.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
begin
  with quickrep1.AllDataSets do
    if IndexOf(Form1.tbCountry) = -1 then
      Add(Form1.tbCountry);
end;

The QRExpr.Expression property would be set to tbcountry.capital.  This is also applicable for the expression property of the TQRGroup band.
------------------
Q.  I want to sum a field, but I need to ignore the highest and lowest value, can this be done?
A.  You can do this by using the expression 'SUM(Field)-MIN(Field)-MAX(Field'.  Please note that if you only have two records, the sum will be zero.
------------------
Q.  What are the allowable datatypes that can be used in a TQRExpr control?
A.  The allowable Delphi datatypes that can used in a TQRExpr control (or Group expression) are longint, double, string[255], and boolean.  Currency fields are stored as double.  Date and time fields are stored as string.
------------------

[Frames]
==================
Q.  How can I separate the letters from the top of the frames with a QRDBText control?
A.  The current release provides no control over the relative positioning of the frame in regards to the text.  You can get finer control by using a QRShape control and place it underneath the text control.
------------------
Q.  Setting DrawBottom to true of the report's Frame property of works on preview, not when printed.
A.  The default bottom margin of a report goes beyond the printable area of many printers.  If you set the bottom margin to a greater value (try 1.0 in as an example), you should see the bottom frame.
------------------
Q.  Some lines do not appear in the preview, but they appear in the printout.
A.  The report is rendered to a TMetafile object when it is sent to the preview.  Depending on the zoom value of the preview, the scaling of the TMetafile may crop out some of the lines.  If you zoom in (you may need to use a custom preview to zoom in close enough), the lines will reappear.
------------------

[Groups]
==================
Q.  How do I print a group footer band?
A.  Add a TQRBand, set it's type to groupfooter and link to rbGroupFooter.  You would then link it to TQRGroup band by the footerband property.  The new band will print at the end of the group of detail band.
------------------
Q.  Is there an expression that will permit grouping by month? The underlying database has a date field.
A.  You have to pass in an expression that would be the month, the easiest way is to use a calculated database field that would be the year and the month (unless you want the same month from multiple years grouped together.
------------------
Q.  I have a billing report. In the group-footer I take the sum of the amounts. I print it at the summary . Now I would like to print the intermediate-results of the amounts at the end of each page (except at the end of the last page). How can I do it?
A.  You would put the TQRExpr component to handle the amounts on a page footer band.  Set the QRExpr's ResetAfterPrint to true so that the total will get reset after each page.  To suppress the final page footer, set the report's Options.LastPageFooter to true.

If you want to have a page footer on the last page, but want to suppress the output of the last page's total, one easy way to tell that you are on the last page is to use a summary band.  It will be called before the last page footer and you can use it's BeforePrint event to set a flag to prevent the output of the final QRExpr total.  If you don't need a summary band, set it's height to 0.
------------------
Q.  When I have a group header for a sub-detail band, the header gets printed twice for the first record and only once for every record thereafter.
A.  If you just want a group header band to print for each set of subdetails, do not use a TQRGroupband, that band is for when you want to break up the data in groups.  Just set the subdetail band's Bands.HasHeader to true.  This will add a band of type TQRBand and it will only print at the start of each set of subdetails.  This is documented on page 5-73 of the manual under the topic "BANDS PROPERTY FOR TQRSUBDETAIL".
------------------
Q.  TQRGroup does not work with an expression on a queryfield if the query component is not on the report form.
A.  The dataset must be either on the form or on the report's datamodule.
------------------
Q.  A new page is not generated on the GROUPHEADER if the current page number is 1 (one) and the Property NewPage is TRUE.  It will work fine if this occurs on page number 2 or higher.
A.  QuickReport was designed to ignore the first ForceNewPage band if that band is on the first page.  To get around this, set ForceNewPage back to false and call the report's NewPage method from the BeforePrint event of that band like the following:
procedure TfrmGroupTest.QRGroup1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  Quickrep1.NewPage;
end;
The ForceNewColumn property works the same way. There is a NewColumn method that can be called to do a a column break on the first group.
------------------
Q.  How do I set a group expression to break on multiple fields?
A.  Set your group band expression to 'Query1.Field1 + Query1.Field2', if they are strings.  If they are not strings, convert them to strings first using the STR() function.  If that does not work, you can create a Calculated Field in your Dataset that is a combination of the fields and have the group.expression use that field.
------------------
Q.  We query our data grouped by a field and is there any neat way to get the text "to be continued" to the bottom of the page if the group is several pages, i.e. how do we know before page change the last row was not the last record in the group?
A.  There isn't a "neat" way to do this with the current version.  You may want to add with some code to the BeforePrint event of the page footer band.  You could check the next row in your dataset to see if the group changes.  Just remember to leave yourself in the original row of the dataset so that you don't skip any rows.
------------------
Q.  How do I get group headers to print after a page break?
A.  Group bands in Quick Report 3 have a ReprintOnNewPage property to do this.  With Quick Report 2, you can emulate repeating group headers through code and some duplicate bands. An example program that shows how to do this can be downloaded from our web site.  Look for the file "repeats.zip".
------------------
Q.  How do I create a group band at runtime?
A.  Before the report starts, you can add a group by creating a control of that type and setting some of it's properties.  The following code would add a group band to a report using the orders table

procedure TfrmCreateControls.FormCreate(Sender: TObject);
begin
  { Create the group on this form }
  QRGroup1 := TQRGroup.Create(Self); { QRGroup1 defined as TQRGroup in the form declarations}

  with QRGroup1 do
  begin
    { assign it to this report }
    Parent := QuickRep1;

    { assign it to the detail band }
    Master := Parent;

    { Set it's expression }
    Expression := 'CustNo';
  end;

  { Now add a text control to this band }
  with TQRDBText.Create(Self) do
  begin
    Parent := QRGroup1;
    Dataset := QuickRep1.Dataset;
    DataField := 'CustNo';
  end;
end;
------------------
Q.  I have several Group Bands in my report. How is it possible to change the printing order of these bands at runtime. Eg. at case one I need to print only Group1, case two Group2, Group 1, Group 3, case three Group 4, Group 2 etc. The order is told by end user at runtime.
A.  QuickReport uses the creation order of the group bands to set the order at runtime.  You can change the ordering of the group bands by calling the their SendToFront and SendToBack methods.
------------------


[Images and Shapes]
==================
Q.  My images do not print consistently.
A.  This can happen for a few reasons.  If you are using a TQRDBImage and the images do not always print, it may be a problem with how the BDE is handling the BLOB data.
Instead of using a TQRDBImage, use a TQRImage and a TDBImage.  Assign the database bitmap to the TDBImage (you will need to add a TDataSource to assign the field to the TDBImage).  In the BeforePrint event of the band that contains the TQRImage, assign the TDBImage's bitmap to the TQRImage's bitmap.
Example:
procedure TfrmImageTest.DetailBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  qrimage1.picture.bitmap.assign(DBImage1.Picture.Bitmap);
end;

If you are using a TQRImage and loading the image directly into the component does not work, try loading the image into a TBitmap and then copying the data to the TQRImage component.
Example 1:
  MyBitmap.LoadFromFile(somefile);  // MyBitmap is a TBitmap that is created and freed somewhere else
  QRImage.Picture.Bitmap.Assign(MyBitmap);
Example 2:
  MyBitmap.LoadFromFile(somefile);
  QRImage.Picture.Bitmap.Height := MyBitmap.Height;
  QRImage.Picture.Bitmap.Width := MyBitmap.Width;
  QRImage.Picture.Bitmap.Canvas.Draw(0,0, MyBitmap);
------------------
Q.  How I do to make background shadow in alternated lines (detail) of report?
A.  Place a TQRShape underneath all of the other controls on the band.  Make sure the transparent property of the text controls on top of the shape is set to true.   In the BeforePrint event of the Band, "toggle" the Brush.Color of the TQRShape.  This will not appear at design time, but will work at runtime. Example:
procedure TfrmMasterDetail.QRSubDetailItemsBeforePrint(Sender: TQRCustomBand; var PrintBand: Boolean);
begin
  { toggle the item background so that we can have alternating colors }
  { like the greenbar paper we all know and love.}
  with QRShape1.Brush do
    if Color = $00F0F0F0 then
      Color := $00E0E0E0
    else
      Color := $00F0F0F0;
end;

This will allow you have a color that does not use up the entire width of the band.  If you want to do the entire band, set the band's color property and leave out the TQRShape.
------------------
Q.  Is there a 3rd party component vendor for QR that supports PNG images?
A.  I don't know of any PNG controls for QR2.  Delphi 3's Image control can be extended to support other formats, if a vendor has provided a package that adds PNG to the standard Delphi 3 TImage control, it should work in Quickreport 2.
------------------
Q.  (Delphi 3) I am trying to use the QRImage component to print a jpg image. I noticed that if I select a jpg image after placing a qrimage component on a quickreport, it shows up correctly on screen. But when I then PREVIEW the report, the image is not there.
A.  Did you add jpeg to your uses clause for that report?
------------------
Q.  Why wont QRImage doesn't print icon files when Stretch is set to true?
A.  The Stretch property has no affect on icons.  This is documented in Delphi's help for the stretch property of TImage (ancestor of QRImage)
------------------
Q.  My shapes don't print correctly on bands that wrap over a page
A.  Right click on QRShape and select print to back so that it get printed first
------------------
Q.  Why do TQRShapes appear thicker on screen than when it prints
A.  There is a known problem where the thickness of the Shape's lines vary between the preview and the printer.  The work around is to set the Shape.Pen.Width property to a variable and set the value depending on whether you are printing or previewing.  In the report's BeforePrint event, you can check the value of the report's QRPrinter.Destination property.  If it's set to qrdMetafile, then it's rendering the preview.  If it's set to qrdPrinter, then it's rendering the report directly to the printer.
------------------
Q.  I'm creating a report which requires a couple of vertical lines on the page.  I have added the appropriate QRShapes (shape=qrsVertLine) to the detail band.  How do I continue the vertical line on the page even when there are not enough detail records to fill the page?
A.  Try dropping a TQRShape directly on the report control (not on a band), and set it's height to fit the printable area of the page.  If you use "Send to back" on the shape, the bands will appear on top of it.  This will give you a continuos shape going down the page.  You may need to add code in the report's BeforePrint event to set the Size.height of the QRShape to the height of the report minus the top and bottom margins.
Note:  This will not work with Composite Reports.
------------------

[Installing & converting from previous versions]
==================
Q.  I have written my application to use runtime packages.  How can I check to see which Delphi runtime packages are required for QuickReport?
A.  In the Delphi help file, Borland recommends installing the runtime package files supplied by Borland in the Windows\System directory.  If you want to include only the minimal number of files, you can check the requires clause in the QuickReport runtime package source code file for the list of required packages.  This file will be in the Quickrpt directory and will be named something like qrpt40.dpk
------------------
Q.  How do I fix the error that the unit was 'compiled with a different version of . . .'.
A.  If you have a professional version, just add the path to the source code to your project search path list in the project options. The code will rebuild and the problem is gone.
------------------
Q.  How can I install the help file?
A.  There is a freeware program for installing Delphi help files named 'HelpLinker'. HelpLinker was developed by Scoutship Software. You can download the program from http://www.scoutship.com/helplinker.htm
------------------
Q.  Where can I get a list of all of the files that were installed when I ran the QuickReport installation program?
A.  Each installer creates or updates a file named install.log in the delphi or c++builder directory.  This is a standard log file that the install programs use and will list the files installed and registry keys that were updated.
------------------
Q.  (Qr3)I just installed 3.0.5 into Delphi and I get access violations when I add a TQREditor component to a form.
A.  If you are using the French or German versions of Delphi or C++Builder, they come with a localized copy of the qrpt40 (or qrpt50, qrpt43, depending on your version of Delphi/C++Builder) package file.  You will need to delete qrptXX.fr (or qrptXX.de) file.
------------------
Q.  After installation of Quick Report 3.0.4 (Professional) for Delphi 4 on my computer, I started to build a new project. But at compilation I encountered the following error: QRPrev was compiled with a different version of comctrls: TToolBar
A.  Have you applied Update Pack 2 (or newer) to your Delphi 4?  This is required for QuickReport as of the 3.0.4 release.
------------------
Q.  I just installed QR 3 into C++Builder 3 and I can't link the project.
A.  Make sure that the project is using qrpt43c as the runtime package instead of the qrtp35 file from QR2.  The QR3 installer will not modify your project files, you may have to manually edit the package list and header files used by the project.
------------------
Q.  How do I install the latest patch to QuickReport?
A.  We do not use patch filesets.  Each fileset that we release is the complete version of QuickReport Pro.  It is not necessary to apply other QR patches when installing an update.  With Delphi 4, we require that you have previously installed Update Pack 2 (or newer) when installing QuickReport 3 Pro.  To install QuickReport 3 Pro, you must exit Delphi and any application that used the Delphi runtime packages.  If you are using any 3rd party packages that link to QuickReport, you must remove them from the package list before installing QuickReport 3 Pro. After QuickReport 3 Pro has been installed, you can rebuild those packages to link in the updated QuickReport files (Please refer to the documentation and/or tech support for those packages when rebuilding them).  After exiting Delphi, just run the QR executable.  It will display the warning message about removing TeeChart and Decision Cube and then install the QuickReport 3 Pro package.  You can then restart Delphi.
------------------
Q.  Do you have any tools that automatically transform files from Delphi 2 and QR1.0 to Delphi 4 and QR3.0 ?
A.  We do not have any tools that will do this.  One way to convert from QuickReport 1 to new versions of QuickReport is to run two copies of Delphi, each one using one of the QR versions.  Start each copy of Delphi with a different version of QuickReport.  Load the QR1 report into the copy of Delphi running with the QR1 components and then create a new report in the other copy of Delphi (the one running the newer QuickReport) Cut and paste the components from the QR1 to the new report until you have rebuilt your report.
------------------
Q.  I installed QuickReport 3 and I can't load the dclqpro package.
A.  The dclqpro package is a QuickReport 2 package and can not be used with QuickReport 3.  The code in dclqpro is now in the main dclrpt40 (of dclqrpt43) package.
------------------
Q.  I can't install QuickReport 3 into Delphi 3.  Even after I remove QuickReport 2, I still get the error "TQuickReport class already exists" when I try to add the QuickReport 3 package.
Q.  I can't install Quick Report 3, it conflicts with WPTools (or any package that uses Quick Report_.
A.  If you have any 3rd party packages that use QuickReport 2 (like TeeChart 3), they will implicitly load the QuickReport 2 runtime package when Delphi loads.  You will need to remove that package or packages before installing QuickReport 3.  After installing QuickReport 3, you can go back and rebuild the packages that used QuickReport 2.  You will need to edit the .dpk file for the package and replace any reference of qrp30 to qrpt43.

1. Remove the package or packages that use QuickReport 2 from the package list.  You must completely remove the package from the list, disabling it will not be enough.
2. Remove the QuickReport 2 packages, DCLQRT30.DPL and DCLQRPRO.DPL
3. Install Quick Report 3
4. Locate and open the package file (.dpk) for the each package.  The name and location of the file will vary.  Some of then may be in the Delphi lib directory, some vendors place them in a separate directory.  If you click on the package in the package list dialog, it should display the name of the directory where the package file is.  The .dpk file should be in the same directory.  You can also use the Windows File Find to locate all of the .dpk files on you machine.
5. Look for any reference to qrpt30 in the requires list in the .dpk file.  This is the Quick Report 2 file.  Remove it and recompile the package.  It should find the QuickReport 3 file, qrpt40 (qprt43 for Delphi 3).  If it doesn't find it or tries to use qrpt30, you will need to manually edit that line and add the QuickReport 3 file.
6. Rebuild the package.

In your Delphi bin directory, you can execute the following DOS command line to get a list of packages that use QuickReport 2
for %x in (*.dpl;*.bpl) do find /I /C "qrpt3" %x

This will list the name of each package and the number of times that the text qrpt3 occurs in that file.  If you have 3rd party packages that are installed to a different directory, you can run that command there.

Another way of determining what packages are dependant on QuickReport 2 would be to exit Delphi and rename the qrpt30.dpl to qrpt30.old (or anything else) in the Windows system directory.  When you restart Delphi, you will get error messages about the packages that are dependant on QuickReport 2.
------------------
Q.  My custom preview doesn't work the way it did with QR1
A.  The preview must be called with Show instead of ShowModal.  This a change from the QuickReport 1 behavior, but is required for QuickReport 2.
------------------
Q.  We have just installed QR20K instead of QR20Kbeta (working with D3 +Language Pack).  We now notice that the Quick Report Units are not translated into Dutch as it used to be with QR20Kbeta.
A.  You will need to uninstall and then re-install the Language Pack.
------------------
Q.  I am porting a report from QR1 to QR2 and the FromPage and ToPage properties are missing.
A.  In QuickReport 2 they are named FirstPage and LastPage.
------------------
Q.  I keep getting the error: "Can't load package (the path & such)" A device attached to the system is not functioning"
A.  Delete the file qrpt30.dpl from the delphi 3.0\bin directory.
------------------
Q.  Recently I upgraded Delphi 3 to Delphi 3.02.  I now get an error trying to install QuickReport 2 Pro package.
Error Message comes back as: Can't load package c:\quickrep\delphi3\bin\dclqpro.dpl.  A device attached to the system is not functioning.
A.  When upgrading Delphi 3 to the new release, you must reinstall QuickReport 2 and follow all of the original instructions.  This error is happening because you did not delete all copies of qrpt30.dpl from your system BEFORE installing QR Pro.
------------------
Q.  I recently received the latest copy of Delphi v3, build number 5.83. Whenever I load Delphi, an error message appears:
    PROCEDURE ENTRY POINT QREXTRA.TQREDITOR AT 7DBEC950 COULD NOT
    BE LOCATED IN DYNAMIC LINK LIBRARY QRPT30.DPL
A.  The Delphi 3.01 maintenance release comes with the standard version of QuickReport 2.0g and it does not come with the QREditor component.  You will need to reinstall your current QuickReport Pro over the one that comes with Delphi 3.01.
------------------
Q.  I am trying to convert a Report from version 1.x to 2.0i, in Delphi 3.  In version 1.x it was possible to have several detailbands in the same report, and then enabling the detailbands as they where needed, thus having different bands visible, depending on a field in the dataset.
A.  QuickReport 2 does not support multiple detail, page header, or title bands, but each band can have a child band and you can control the output of each band individually at runtime.  Please see the manual topics on ChildBands for more information.
------------------
Q.  The TQRGroup property GroupData was in Version 1 does not exist in QuickReport 2.  Is there a replacement?
A.  The QuickReport 2 does not have a groupdata property, it has an expression property for determining group breaks.  Setting this property is documented on page 2-41 of the manual.
------------------
Q.  [Delphi 3] How can I restore a German layout during runtime in the Preview ?
A.  The German resource files supplied with Delphi 3 does not work with current release of QuickReport Pro.  We will post a revised German resource file as we can get it updated.
------------------
Q.  I updated to QuickReport 2 with C++ Builder and I can't compile my existing QR1 reports.
A.  In addition to following Appendix C in the manual, C++ Builder users will have to remove the following line from their source code:
#include <vcl\QuickRep.hpp>
This file is part of QuickReport 1 and will cause conflicts when compiling with QuickReport 2
------------------
Q.  The QRGroup in version 1.0 had a field called DataField, in the 2.0 version this field doesn't exist. In the unit that called the report I would set the contents of this field. How do I do it now?
A.  The QuickReport 2 QRGroup has an expression field that works like the expression property of a QRExpr component.  This is documented on page 5-102 of the manual.
------------------
Q.  I cannot run the QuickReport 2 demo programs in Delphi 1.
A.  We apologize for that, but that error will not stop Delphi 1 from compiling the QR2demo.  If you select "Ignore All" when errors pops up when loading a form, the project will run under Delphi 1.  Just load each form and save it back out again.  The errors will only appear once.
------------------
Q.  I could not find the Linkband feature that QR1 has.
A.  This is was not in Quick Report 2, but returned in Quick Report 3
------------------
Q.  When compiling and starting the qr2demo.dpr the following error occurs: Error while reading GrpListForm.Font.Charset. Property does not exist !
A.  The version of Delphi that you used did not support that property, you should be able to load the form by selecting "Ignore All" on the error dialog.
------------------
Q.  In QR1, we had ShowDialog Property to Show PrintSetup Dialog before Print, but in QR2 does not have this. How can I do this function?
A.  If you call the Report's PrinterSetup method, this will set the printer settings for the report before you run it.  You could do it like:

  with frmReport do
  begin
    QuickRep1.PrinterSetup;
    QuickRep1.Preview;
  end;
------------------
Q.  I installed QuickReport Professional version 2.0 in my Delphi 3.0, all went well and the two new components were installed. When I try to run the example project for the QREditor Component, EDITOR.DPR, I get a error message in line 41 of the QREDFOR unit that says: Undeclared identifier: TQREditor.
A.  Please make sure that you have enabled the dclqlpro.dpl package under project options.  This package is labeled "Delphi QuickReport Professional Components" and it should be in your "...\Delphi 3\bin" directory.
------------------
Q.  I just installed QuickReport 2 Pro, but I can't find the editor component
A.  This control gets installed when you install QuickReport, it's usually one of the rightmost components on the qreport pallet.
------------------
Q.  After I install QuickReport Pro into Delphi 3, I only see the QREditor and QExprMemo components
A.  Make sure that you have selected the dclqrt30.dpl package
------------------
Q.  My QuickReport right-click menus have blank lines (German release of Delphi 3)
A.  In the "bin" directory of delphi, delete the file "dclqrt30.DE".  In the windows system directory and in delphi 3.0\bin, delete "qrpt30.DE"
Borland is using "FR" extension for the French release. So you need to delete all copies of "dclqrt30.FR" and "qrpt30.FR" before installing QR2 Professional.
------------------
Q.  I keep getting CGI time outs when I try to download from your web site.
A.  We have had some technical difficulties on our server and with our ISP.  If you get an error, please
    again later.
------------------
Q.  I have upgraded to version 2.0 from 1.1. Since then I can't load an already saved report.
A.  The saved reports from QuickReport 1 are not compatible with QuickReport 2
------------------
Q.  What happened to the thumbnail feature of QR1?
A.  Thumbnails are not supported in QuickReport 2.0.
------------------
Q.  I tried to download a file from your web site but I get the 'Document contains no data' message.
A.  The maximum number of users that can access our web site may have been reached.  Please wait a few minutes and try again.
------------------
Q.  How can I tell which version of QuickReport is installed in Delphi?
A.  When you right-click on the QuickReport component, the version is displayed as the first line of the pop-up menu.
------------------
Q.  I have removed QuickReport from the package list but how do I reregister it?
A.  That means that you will need to add that package back into Delphi using the Component->Install Packages menu.
------------------

[Master/Detail reports]
==================
Q.  How do you do multiple subdetail bands at the same level?
A.  You would use multiple subdetail bands, one for each child table. The master property of each subdetail would be set to the report.
------------------
Q.  Is there any way to print the set of subdetail bands before the detail band?
A.  Set the subdetail band's PrintBefore property to true and it will print before the detail band.
------------------
Q.  My master/detail reports do not print any of the detail records.
A.  There are a few things to check.  Make sure that the subdetail's dataset property is set to the correct dataset.  Make sure the subdetail band's dataset (the detail) is linked to the dataset of the report (the master).  With TTables, this is done through the MasterSource and MasterFields properties.  With the TQuery component, you would have set Params properties.  Also check to see if you are setting the DisableControls property of the master dataset, this will disable master/detail relationships.
------------------
Q.  I would like to know if it is possible to include subreports into reports like Microsoft Access.
A.  QuickReport 2 has a similar feature with the TQRSubDetail band.  This is documented in the manual and help files.  Additional information can be found in this section of the Knowledge Base.  A Master/detail tutorial project is available on our download page.
(QR3)  The QR3DEMO project on our download page includes a couple of master/detail reports.
------------------
Q.  How do I insert a new QRsubdetail band in between two existing subdetail bands? I have a very long report and when I insert a new band at the end and use the "move band up" option on the pop-up menu, it seems to really mess the report up.
A.  QuickReport uses the creation order of the group bands to set the order at runtime.  You can change the ordering of the group bands by calling the their SendToFront and SendToBack methods.
------------------
Q.  How do I create a QRSubDetail band at runtime?
A.  The following code creates a subdetail band and adds a QRDBText control to it:
  SubBand := TQRSubDetail.Create(self);
  MyText := TQRDBText.Create(self);
  with SubBand do
  begin
    Height := 20;
    Parent := QuickRep1;
    Master := QuickRep1;
    Dataset := tbOrders;
  end;
  with MyText do
  begin
    Top := 0;
    Left := 10;
    Parent := SubBand;
    Height := 17;
    Dataset := tbOrders;
    DataField := 'OrderNo';
  end;
------------------
Q.  I could not get the SUM() expression to work on subdetail bands.
A.  Make sure that you have Master property of the QRExpr control set to the SubDetail band.
------------------
Q.  I have a two level report where I on the primary level tries to cancel the output for both levels by setting the printband property to false for some of the primary records. Why is the secondary level printed anyway? How can I avoid this?
A.  The PrintBand feature was designed to work independent of any other band.  In this case, one work around would be to set the detail band's tag property to 1 when print and 0 when you do not print.  When you get to the subdetail, set it's PrintBand to true only when the detailband's tag property is greater than 0
------------------
Q.  I want to make a report with 2 subdetails. The first subdetail works fine, but the second I need that it has 2 or 3 columns but I don't know how can I make that a subdetail can have 3 columns and the other sections has only one column.
A.  You can not do this with QuickReport at this time.  The number of columns applies to all detail and subdetail bands.  One work around is to put three sets of TQRLabels on your second subdetail band and manually handle the columns.  In the BeforePrint event of the band, you would populate the first set of QRLabels.  You would then call the dataset's Next method (if not EOF) and populate the 2nd set of QRLabels. If not EOF, you would  do one more time for the 3rd set of labels.
------------------

[Misc]
==================
Q.  I put a report on a Frame and then placed the frame on a form.  I can't add any controls to the report.
A.  This is a known limitation, QuickReport will not work correctly when placed on a TFrame.
------------------
Q.  I have a report than runs fine on my machine, but when I compiler or run it on another PC on the same network, it doesn't work right.
A.  You want to make sure that you have the latest version of QuickReport installed on all of your development machines.  If you are deploying with runtime packages, you have to make sure that the current QuickReport runtime package is being deployed.
------------------
Q.  We are deploying our application with runtime packages.  Is there an easy way for my users to tell me which version of QuickReport is being used by my program?
A.  The string constant cQRName contains the text 'QuickReport x.x.x', where x.x.x is the current version number.  This constant is defined in qrprntr.pas
------------------
Q.  I am getting errors trying to preview reports with QuickReport 2 under Windows 2000
A.  We do not support QuickReport 2 under Windows 2000, we only support QuickReport 3 under Windows 2000.  You can get it to work, but you will need to change the TempFileName function in qrprintr.pas and recompile the package.
Replace the existing function with the following:
function TempFilename : string;
var
  AName,
  ADir : array[0..255] of char;
begin
  GetTempPath(255, adir);
  GetTempFilename(aDir, PChar('QRP'), 0, aName);
  result := StrPas(aName);
end;
This is not supported but should take care of the problem.
------------------
Q.  Is there any way of trapping the error if the computer does not have enough disk space to preview, print, or export a report?
A.  We currently do not have any mechanism for checking disk space requirements, but it's currently on our request list.  One way to deal with this situation would be to use the report's OnStartPage event to check to see if there were enough room in the temp directory and if not call the report's Dataset.last method to stop the report.  There isn't any simple way of knowing how much space each report page take, it depends on the contents.  I would pick a high number like 1 meg as Windows will have other problems if you are that low on room.
------------------
Q.  How can I get the length of some text before I print the band?
A.  The report object has TextWidth() and TextHeight() functions that you can call from the OnNeedData event.  Just pass in the font to use and the text to measure.
------------------
Q.  The recordcount is very slow in Delphi if there is OnFilterRecord event connected because all the dataset will be scanned to return the number of records.  How can I speed that up?
A.  Using the OnFilterRecord event is not very efficient when used with QuickReport.  Not only is it slow with the preview, but printing from the preview would cause the filterevent to hit for every record again. It would be faster to use a TQuery component and filter the data with the SQL statement.  If that is not possible, create a temporary table and populate it with the data from the filtered table and have QuickReport use the temporary table.  It would preview and print much faster than a table that uses a filter.
------------------
Q.  If I change the size-property in the Objectinspector, the size has the Unit in MM. If I change the size in the BeforePrínt-Event the Unit seems 1/10 MM, so I must multiply my Value's by 10. Is this an error?
A.  At runtime, the report switches to native units, which are in 1/10 mm.  We switch the units to native so we can be as precise as possible.
------------------
Q.  Is there any difference between having a report on a form or by itself?
A.  We have found that porting reports from one version of Delphi or C++Builder to another to be very problematic if the report is not on a form.  Having a report on a form is more flexible because you can use the form's Create/Destroy events to create and free accessory datastructures.
------------------
Q.  What files are needed to deploy applications using QuickReport?
A.  If you are using runtime package, you need to include the QuickReport (example: qrpt40.bpl) package with the other runtime packages, otherwise no additional files are needed specifically for QuickReport.
------------------
Q.  I get access violations with QuickReport 3 when I call the preview repeatedly
A.  This is an open issue that we are still working on.  The work around is to call Application.ProcessMessages either before or after each call to Preview.  This will allow each preview to close down properly before the next one starts.
------------------
Q.  My reports do not print when they are run under NT's Scheduler (AT command) or as a service (TServiceApplication).
A.  From Microsoft's Knowledge base article Q152451 (http://support.microsoft.com/support/kb/articles/Q152/4/51.asp) : Printing fails because no default print device is defined for the service account.  This article has a lengthy work around listed.
------------------
Q.  I get an access violation when I close the report's dataset in the report's AfterPreview event.
A.  You can not close (or free) the report or it's dataset in this event.  You would do that type of code after the call to Preview returns.
------------------
Q.  Is it possible to have a QR DBText,QRLabel, or QRSubdetail with an OnClick event?  When I'm previewing a report I would like to Click on something (band,field,label, etc) to launch another report.
A.  This functionality does not exist in QuickReport 3, but this is planned for QuickReport 5 due out later this year.
------------------
Q.  How do I create crosstab or pivot reports with QuickReport?
A.  QuickReport does not have crosstab (aka pivot table) support built in, but you can create reports with some work.  We have example reports on our download page that show two methods of writing a crosstab report.  The crosstab.zip file contains a crosstab report built using an array.  The CUBE_RPT.ZIP file contains a report that prints the data displayed in a Decision Cube.
------------------
Q.  My report crashes under Windows 2000 and/or Windows NT
A.  In qrprntr.pas, there is a function named TempFileName and it is probably not allocating enough characters for the path to the Windows temp directory.  This has been addressed for QR 3.0.5.  For QR2, you can replace the function with the following code:
function TempFilename : string;
var
  AName,
  ADir : array[0..255] of char;
begin
  GetTempPath(255, adir);
  GetTempFilename(aDir, PChar('QRP'), 0, aName);
  result := StrPas(aName);
end;
------------------
Q.  My customer's PC is set to use "Large Fonts" for the display font size.  This changes the layout and size of my report controls.
A.  Delphi will scale the components if you have the form's Scaling property set to True.  With QuickReport, you should always set this property to false.
------------------
Q.  What is the most precise way to set the position or size of a QuickReport component on a band?
A.  If you set the report units to Native, the component's Size properties (Size.Length, Size.Left, etc) will be measured in 1/10 of a mm.  When the report runs, we switch the units to native so we can be as precise as possible.
------------------
Q.  I want to print my reports to Adobe Acrobat PDF files.  Is there any way to bypass the file dialog box and pass in a file name to save the PDF file as?
A.  Adobe has a technical document that explains how to do this at http://www.adobe.com/supportservice/custsupport/SOLUTIONS/10a6a.htm
------------------
Q.  I am trying to use the new Euro character.  It shows up in the preview, but it prints as a block
A   Your printer driver may need to be updated.  Microsoft has detailed information on this at http://www.microsoft.com/windows/euro.asp
------------------
Q.  I am writing my own control for QuickReport, how I do convert my units so that control is the correct size for the preview and the printout?
A.  You would use the qrprinter's XPos() and YPos() functions to convert absolute measurements in 0.1mm units to the actual device coordinates.  In the TQRShape.Print method in qrctrls.pas, there are a few examples of how we use XPos() and YPos() to handle the scaling for the drawing of shapes.
------------------
Q.  I am printing the report in duplex and I want every other page to only print some static text.
A.  One way to do this would be to use a ColumnHeader band and use the BeforePrint and AfterPrint events of that band to control the printing.  If you are currently using a ColumnHeader band, add a child band to the ColumnHeader and move your existing Column Header controls to the child band.

In the BeforePrint event of the band, set it so it only prints on even numbered pages.

Example:
procedure TfrmMDDuplex.ColumnHeaderBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  // Print only on the even pages
  PrintBand := (QuickRep1.PageNumber > 1) and ((QuickRep1.PageNumber mod 2) = 0);
end;

In the AfterPrint event, force a new page when the column header band has been printed.

Example:
procedure TfrmMDDuplex.ColumnHeaderBand1AfterPrint(Sender: TQRCustomBand;
  BandPrinted: Boolean);
begin
  // If we printed the band, force a new page
  if BandPrinted then QuickRep1.NewPage;
end;
------------------
Q.  I am trying to reset the page number for every group band.  How can I do that ?
A.  This is not supported by the QRSysData control.  You will have to track the page number manually and assign the value to a TQRLabel.
------------------
Q.  Does Quickreport support BDE alternatives such as ODBC98?
A.  As long as the 3rd party package supplies a descendant TDataset control it should work.  I use OBDCExpress and their TOEDataset control works just fine with QuickReport 2 and 3.  The general rule of thumb is that if the regular Delphi data aware controls work with your 3rd party TDataset, then QuickReport will work too.  The release of QR3 bundled with Delphi 4 would not work with non thread safe database drivers (like SQL Links or Opus), but this was addressed in the 3.0.1 release.
------------------
Q.  My report uses tables on a datamodule and even when my report form is using the datamodule, I can't get the tables or fields to show up.
A.  Make sure that the datamodule is loaded when you are setting the fields at design time.
------------------
Q.  I use the following procedure to create forms at run time:
procedure TfmMainForm.ShowModalForm(FormClass: TFormClass);
begin
  Screen.Cursor := crHourGlass;
  with FormClass.Create(Application) do
  try
    ShowModal;
  finally
    Free;
  end;
  Screen.Cursor := crDefault;
end;
Usage: ShowModalForm(TfmSpecialForm), ShowModalForm(TfmOtherForm);

I need a similar routine to create reports.
A.  The FormClass is specific to forms and you can not do the same thing with the report class.  Put the report on the form and use the form's FormShow event to call the report's preview.
------------------
Q.  Is there a way to reset the page number based on a group header?  This would be useful when printing invoices.
A.  Instead of using a TQRSysdata control, use a TQRLabel and manually track the page number.  You can increment and reset that value in your code based on the events that you select.  Then in the footer band, set that TQRLabel's Caption to the string value of the page number.
------------------
Q.  Is it possible, to use the MS Intellimouse's wheel inside the preview of quickreport?
A.  This should be handled by the OS or by the mouse driver.  With Win98, the mouse wheel support is in the OS, with Win95 you can enable the wheel with the Intellimouse 2.2 driver from MS.  I have tested the preview with Intellimouse 2.2 under Win95 and the preview could be scrolled by the wheel.
------------------
Q.  What's the difference between this file and QR2FAQ.TXT?
A.  QR2FAQ.TXT was intended to list the current release notes along with some common questions.  This file is basically the most common questions (and some uncommon ones) that the users have sent in.
------------------
Q.  When I set the height of the report, it keeps going back to the default value, is this a bug?
A.  The height value of the report is derived from the page size.  If you manually set this value, it will snap back to the calculated value.
------------------
Q.  It is difficult to manage reports with many bands. Is there a better way to create complex reports ?
A.  When I have a single report with many bands, I set the height property of the bands that I am not working on to a small value to shrink them out of the way at design time.  I assign the actual height to the band's tag property and at runtime, I just copy the tag to the height property to expand the band back out.
------------------
Q.  I want to print reports with text and pictures. Each of the pictures (two in a row) shall have a caption. Now it sometimes happens that the caption is printed on the first page, but the pictures on the next page. How can I keep that together?
A.  Right-click on the image controls and select "send to back".  This put the images at the top of the creation order on the band and they will be printed first, forcing a page break if needed.
------------------
Q.  I want a 1.5" top margin and 0.5" bottom margin on odd numbered  pages and a 0.5" top margin and 1.5" bottom margin on even pages.
A.  You can't change the margins while the report is running.  One work around would be use Childbands on the page header and page footer bands and selectively print the Childbands on every other page.  First set the top and bottom margins to 0.5".

For the footer band, you add a blank child band of 1" in height.  In that band's BeforePrint event, you would set PrintBand to true only on even numbered pages.  This will give the appearance of increasing the bottom margin by 1" on the even number pages.

For the Headerband, you would do almost the same thing.  You add a child band and move all of the header information from the actual page header band to the childband.  You then set the height of the pageheader band to 1" and in it's BeforePrint event, you would set PrintBand to true only on odd numbered pages.  This will give the appearance of increasing the top margin by 1" on the odd number pages.
------------------
Q.  How can I set the contents of the page header based on the first subdetail band that prints on that page?
A.  You could do this by using Childbands on the page header.  Use group footer bands (if you don't actually need one, set their height to 0 before the report starts) and in the BeforePrint event of the group footer, set a global variable to a value that would represent the next subdetail band.  When the it comes time to output the child bands on the pageheader, you would set their PrintBand variable in their BeforePrint event based on the value of that global variable.  Since the variable is being updated when a subdetail is finished, if you hit the page header that means that there is more data.  You would not want to increment the value by 1 each time, that would get out of synch when a subdetail band did not have any data.  Remember to initialize the global variable in the report's BeforePrint event.
------------------
Q.  All of my fields come out blank.
A.  Did you set the dataset property of the report to an active dataset?
------------------
Q.  An error appears when we set the "Orientation" in the "Page" property to "poLandscape" and the "PaperSize" property to "Default". If we now call the Preview, the following error message appears on the screen : "Error on floating point operation".
A.  There is a known problem with QR2 if you change the orientation at runtime when the paper size is set to Default or Custom.  This will be addressed in a future release.  One work around would be to use the following code:

  {Get the current papersize from the default printer and set the report to use it}
  QuickRep1.QRPrinter.Create;
  QuickRep1.QRPrinter.Printerindex := -1;// for default printer
  QuickRep1.Page.PaperSize := PaperSize;
  QuickRep1.QRPrinter.Free;

  QuickRep1.Print;
------------------
Q.  When I use the Apollo driver to access a Foxpro table and I can not preview reports that use QRDBText controls with MEMO fields.
A.  It has been reported to use that if you have the Apollo driver configured so that the BDE can also be used, you can get this problem. Setting the Apollo driver so that it's the only driver has been reported to fix this problem.
------------------
Q.  I have two forms, Form1 contains a TTable, Form2 contains a TQuickRep. Form2 includes Form1 in its uses clause. I place a TQRExpr on the report, and open up the Expression property editor by clicking ellipsis. The table in Form1 cannot be viewed/selected in this editor.
A.  You will need to use the report's AllDataSets property to add datasets from other forms.  This is documented in the manual under the "AllDatatSets" topic.  Please note that you should use the AllDataSets's Add method in the report's BeforePrint event.  This is also applicable for the expression property of the TQRGroup band.
------------------
Q.  Is there any way to perform "Hide Duplicates" for some repeated data item in a report?
A.  You would have to store the previous field value in a variable and compare the current field against it.  You would reset the variable in the report's BeforePrint event and compare the variable against the current dataset field in the control's OnPrint event.

Example:
  LastVar is defined as string the form's public section

procedure TfrmSub2.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
begin
  { Clear our variable }
  LastVar := '';
end;

procedure TfrmSub2.QRDBText5Print(sender: TObject; var Value: string);
begin
  {
  If this field is same as the last one, then we clear it. If it's new
    we set our variable to that field and let this one print
  }
  if Value = LastVar then
    Value := ''
  else
    LastVar := Value;
end;
------------------
Q.  Using QR2 and trying to call addprintable in the beforeprint event of a band causes a GPF (or an Access Violation). Is this not allowed for some reason?
A.  You can only call AddPrintable or otherwise add a control to a report band before you start the report.  QuickReport needs to know about all printable controls before it starts the report.
------------------
Q. If I print a invoice with two lines at the bottom of a page, I have this problem. The pagefooter is necessary because the lines of Subdetail prints at bottom of the page. The first page is Ok. On the second page, the last page of invoice, in GroupfooterBand1Beforeprint I have
  QRFooterband.enabled := false;
  QuickRep1.ResetPageFooterSize ;
The pagefooter doesn't print, but Groupfooterband does not align to bottom.
A.  If you call this code from the group footer's BeforePrint event, it is too late, it's print position has already been set.  What will work is if you that code in the PageHeader's BeforePrint event.  If you are not using a PageHeader band, add an empty one to do this code and then set PrintBand to false to suppress the output of the PageHeader.
------------------
Q.  Why does QuickReport change my detailband's Size.Height property from 33.0 to 33.07 after I preview a report?
A.  Try setting the report's SnapToGrid property to false, that should keep the band from resizing.  The Delphi IDE will also round certain values, if you set the value to a slightly smaller value, it should round up to the correct value.  If the rounding error is really throwing your report off, you can always set the value at runtime and it will not get rounded.
------------------
Q.  How can I convert from pixels to the measurement unit used by the QRPrinter object to be able to print to the screen or printer?
A.  QRPrinter.XSize(aNumber * ParentReport.TextWidth(Font,'W')) should do the trick.
------------------
Q.  My shapes print out thinner than they appear in the preview
A.  This is a known issue that we are researching.  A user sent in the following work around: I can get the thick line by changing then shape to qrsrectangle with a width of 2 and change the brush color to clblack.
------------------
Q.  In my report I want to print a blank line every between every 5 lines with data, to make it easier to read. How can I do that?
A.  On every 5th record, double the height of the detail band in the BeforePrint event. In the AfterPrint event, reset it back to normal.
------------------
Q.  How can I make a row wider than 1 page.
A.  This is not currently supported.  One alternative would be to use multiple subdetail bands and run through the data set a couple of times, for each set of columns.  Let say that you have 20 columns and only 10 will fit on the width of a page.  Leave out the detail band and set PrintIfEmpty to true.  Set each subdetail band to the same dataset and put different columns each.  Each subdetail will print all of the records but with different columns.  You will need to call the dataset's first method after each subdetail set has been executed.
------------------
Q.  Can you tell me how I can view the non-continuous rows in a DBGRid by using QuickReport? I set dgMultiSelect from TDBGrid to True, and I select some records in non-continuous order, then ...?
A.  You'll need to use the QuickReport OnNeedData event (it's in the manual) to pull data from a DBGrid.  In the OnNeedData event, try the following code:
MoreData := DBGrid.SelectedRows.CurrentRowSelected;

Another method would be populate a temporary table with the selected rows and have the report work with the temporary table.

See also 'Abstract table'.
------------------
Q.  How can I put a blank page in front of a report.
A.  Put a blank title band on the report and call the report's NewPage method in the title band's AfterPrint event.
------------------
Q.  How do I print a text file as a report?
A.  There are several ways to do this.  The qrprntr example project in the \quickrep\demos\qrprntr directory prints a text file using the TQRPrintJob class.  You could use a single detailband and read the text file into a QRMemo, just make sure to set PrintIfEmpty to true.  Or you could use the OnNeedData event and read the file line by line and set a qrlabel.caption on the detail band to the current line.
------------------
Q.  How do I change the Delphi help file to be able to search in the new QuickReport Help?
A.  You need to use Borland's Help file installer (helpinst.exe) add 3rd party help files to your system.  Please see your Delphi documentation for information on the usage of the Help file installer
------------------
Q.  I am having trouble with the QRChart control.
A.  This control is a QuickReport compatible component written by Tee-Mach.  Please contact them at http://www.steema.com/ for all QRChart support questions.
------------------
Q.  I'm having trouble placing controls at precise locations when the I have the report set to 50% zoom
A.  You should keep the zoom value at 100% when adding controls to a form, otherwise you will not be able to have precise control over the placement of the controls.
------------------
Q.  What is the difference between the global QRPrinter, the preview's qrprinter, and the report's, qrprinter?
A.  Each report has it's own QRPrinter object.  There is a global QRPrinter object that can be used outside of the QuickRep object.  Each QRPrinter is a distinct object.
The Preview's QRPrinter object is just a pointer to the QRPrinter of the report using that preview.  When you reference the preview's qrprinter, you actually referencing the qrprinter object of the report currently being previewed.
------------------
Q.  How do I print out text rotated at an angle?
A.  We have added a rotated text control in later versions. If you don't have them, use this method.

Rotating fonts is a straight forward process, so long as the Windows
font mapper can supply a rotated font based on the font you request.
Note: Using a TrueType font virturally guarantees success.

Here is an example of creating a font that is rotated 45 degrees:

procedure TForm1.Button1Click(Sender: TObject);
var
   lf : TLogFont;
   tf : TFont;
begin
   with Form1.Canvas do begin
     Font.Name := 'Arial';
     Font.Size := 24;
     tf := TFont.Create;
     tf.Assign(Font);
     GetObject(tf.Handle, sizeof(lf), @lf);
     lf.lfEscapement := 450;
     lf.lfOrientation := 450;
     tf.Handle := CreateFontIndirect(lf);
     Font.Assign(tf);// assign the font to canvas
     tf.Free;
     TextOut(20, Height div 2, 'Rotated Text!');
   end;
end;

Use code similar to this to create a font, then assign it to a QRLabel or other
control after the report has started. Use an event like the beforePrint of the report.

var
   lf : TLogFont;
   tf : TFont;
begin
     tf := TFont.Create;
     tf.Assign(QRLabel1.Font);
     GetObject(tf.Handle, sizeof(lf), @lf);
     lf.lfEscapement := 450;
     lf.lfOrientation := 450;
     tf.Handle := CreateFontIndirect(lf);
     QRLabel1.font.assign( tf );
     tf.free;

In C++.

//----------------------------------------------------------------------
-----
//   Function:  DrawAngleText
//       Date:
// Parameters:
//    Returns:
//   Comments:  Draw text at an angel on a canvas.
//              Only works with true-type fonts
//              Image1->Canvas->Font->Name = "Arial";
//              DrawAngleText(Image1->Canvas, 50, 100, 90, "Hello
World!");
//----------------------------------------------------------------------
-----
void DrawAngleText(TCanvas *ACanvas, int X, int Y, int Angle, AnsiString
Text)
{
    TLogFont LogFont;
    HFONT OldFont, NewFont;

    //we set the Canvas font handle properties to our LogFont structure
    GetObject(ACanvas->Font->Handle, sizeof(LogFont), &LogFont);

    //now all we have to do is change the angle
    LogFont.lfEscapement = Angle * 10; //this does the rotation
    LogFont.lfOrientation = Angle * 10; //this does the rotation

    //create font handle
    NewFont = CreateFontIndirect(&LogFont);

    //save old font handle and assign new font handle
    OldFont = SelectObject(ACanvas->Handle, NewFont);

    //Print the text
    ACanvas->TextOut(X, Y, Text);

    //restore old font handle and get the 'new' one
    NewFont = SelectObject(ACanvas->Handle, OldFont);

    //delete our created font handle
    DeleteObject(NewFont);
}


// put a call to this in the beforePrint event of the band

void RotateLabel( TQRLabel *label, int Angle )
{
    TLogFont LogFont;
    HFONT NewFont;
    ;
    //we set the Canvas font handle properties to our LogFont structure
    GetObject(label->Font->Handle, sizeof(LogFont), &LogFont);

    //now all we have to do is change the angle
    LogFont.lfEscapement = Angle * 10; //this does the rotation
    LogFont.lfOrientation = Angle * 10; //this does the rotation

    //create font handle
    NewFont = CreateFontIndirect(&LogFont);
    label->Font->Handle = NewFont;
}

void __fastcall TForm1::QuickRep1BeforePrint(TCustomQuickRep *Sender,
      bool &PrintReport)
{
     // rotate font
     RotateLabel( QRLabel2, 45 );
}

------------------
Q.  How can I to begin a report (QR) with current record and then continue from that record?
A.  QuickReport starts with the first record of the dataset, you will need to have the dataset return a set of records starting with the one that you want to start with.  If using the TQuery, use the WHERE clause of it's SQL property to specify the starting record.  With TTable, you can use it's filter properties (Delphi 2 or higher).
Another way would be to use the OnNeedData event to navigate through the dataset, this would work, but would require more code than limiting the dataset through their own properties

procedure TfrmQR.DetailBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  with frmQR do
  begin
    if FirstRec > 0 then
       PrintBand := QuickRep1.RecordCount >= FirstRec;
    if PrintBand then
      if LastRec > 0 then
        PrintBand := QuickRep1.RecordCount <= LastRec;
  end;
end;

This has NOT been tested, you may have to modify it to get it to work
------------------
Q.  How do I do duplex margins?
A.  QuickReport does not have the built in ability to do duplex margins.  You should be able to do this by changing the margins in the AfterPrint event of the page footer band.
------------------
Q.  How do I keep the preview from rebuilding the report when I print?
A.  When you print from the preview, the report is rendered again.  The reason is the preview is rendered to a metafile, and the output looks better if it's directly rendered to the printer canvas.  You can override this behavior, when you print a previously saved report, the preview metafile is sent to the printer.

For QuickReport 3: You can set the report.qrprinter.master property to nil in the BeforePrint event of the summary band.  If you don't need a summary band, you can set PrintBand to false in that event.  You could also use a custom preview and change the print button to call the preview's qrprinter.save to a temporary file and then qrprinter.load.  You would then call the qrprinter.print method to print the loaded report.  The custom preview demo for QuickReport 3 on our download page has example code to show how to do this.

For QuickReport 4 and higher set the flag PrintMetafileFromPreview to true. The flag is in unit quickrpt.
------------------

Q.  How do I do a title page?
A.  For single column reports add a title band and call the report's NewColumn method from the title band's AfterPrint event.
A.  For multiple column reports, add a title band and set it's height so that no other band will fit on it's page.  One way would be to use the report's BeforePrint event to set the titleband.size.height property

The following assumes a page header and footer band...
procedure TfrmQR.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
begin
  with QuickRep1.Page do
    titleband1.size.height := Length - TopMargin -
      BottomMargin - PageHeaderBand1.Size.Height - PageFooterBand1.Size.Height;
end;
------------------
Q. I can't get AddPrintable to work
A. The Addprintable does not work the way the manual states it will.
The following wont compile:

  with DetailBand1.AddPrintable(TQRDBText) do
  begin
    DataField := 'Test';

While this will:
  with TQRDBText(DetailBand1.AddPrintable(TQRDBText)) do
  begin
    DataField := 'Test';
------------------
Q.  Is there a maximum length/size of a report?
A.  There are no limits on the size of report that can be printed. Preview is limited by the amount of free disk space, however disk usage can be significantly reduced by enabling QuickReport's internal compression.
-----------
Q.  How do I print only the current record of the dataset?
A.  To print the current record, clear the DataSet property of the report and set the report's PrintIfEmpty property to True.
------------------
Q.  I define multiple TQRlabels on a page.  I can not find the end of the qrlabel.caption to figure out where to start the next qrlabel.
A.  If you use the size properties, this should be easy to do.  If you have two labels, qrlabel1 and qrlabel2, then you would use the following syntax:
qrlabel2.Size.Left := qrlabel1.Size.Left + qrlabel1.Size.Width after you have set the caption properties.
------------------
Q.  Quickreport seems to leave a trail of files of the form QRPDxxx.TMP in the windows temp directory.  Is this a result of normal operation, crash or aborted preview?
A.  These files are created when you preview a report and are deleted when the preview exits.  If your report crashes or is terminated by the IDE, these files will not be removed.  You can safely delete these files at any time.  If you call the Prepare method and do not free the QRPrinter object and set it to nil, it can leave a QR*.tmp file behind.
------------------
Q.  I get the error "Metafile is not valid" when I preview a very simple but large report (2,500,000 lines). The same report with a smaller data table runs OK.  Why do I get this error?
A.  Are you running out of disk space?  QR renders the report to a temporary file and you will get that error message if you are running out of room.  Try setting the report's Options.Compression property to true and see if the report will run.

Make sure the projects 'Record align' property is set to 8. You can do this in the project options or by adding a directive {$A8} to the code.
------------------
Q.  I have an invoice form. If in the form can't put all the details records in one page, and it must go to the next page, I must put a message in the bottom of the form saying something like this " continued on the next page..." or "carried forward ...".  Which is the best solution for this?
A.  There are a few ways to do this.  One way would be to use a summary band with height set to zero and TQRLabel on the page footer that has the text " continued on the next page...".  In the AfterPrint event of the summary band, set the caption of the TQRLabel to ''.  If the summary band prints on the first page, the label will be cleared, if it gets called on the next page, the first page will print the label.
------------------
Q.  How can I do subscripts for chemical formulas?
A.  You would have to use a TQRRichText or a TQRDBRichText control and insert the RTF codes to the text effect.  If you are not familiar with the RTF format codes, an easy way to get the codes is to type the text in MS Word with the formatting and save the file out as a RTF file.
------------------
Q.  I tried using the OnPrint event to change the font style but it does not respond.  Will it show up in the preview, or do I have to compile and run the report from Delphi?
A.  Any code that you put in an event handler will only be executed at runtime.
------------------
Q.  I have a report with just a page header and a title band.  The title band has a memo control that can span multiple pages.  When it does span a page, the text in the memo starts getting chopped up the closer you get to the bottom of the page.  What is wrong?
A.  The report will not work properly without a detail band.  It was designed around it and leaving it out will have odd side effects like the one that you described.  The work around is to add an empty detail band (no controls with it's height set to 0) and the report should print normally.
------------------
Q.  The graphics mode of my dot matrix mode is too slow, so I'd like to know if there is another way to print using the text format of the printer.  I must print using the standard size and the compressed size of the fonts as we used to do in the DOS environment...
A.  QuickReport was not designed to do that kind of printing, you will need to be able to set your printer driver that way and I do not have any information on that.

An alternative means would be to use the ASCII export filter to send the report to a text file and then copy that file to the printer.  To set any printer and/or font properties, you would have to edit the text file and insert the characters or use a similar method.
------------------

[Multiple Columns]
==================
Q.  Is it possible to set the width of each column if the page has 4 columns ?
A.  The width of the column is the determined by the number of columns divided by the page width, then subtract the report.page.columnwidth value.  You can not set the width of a band directly.
------------------
Q.  I have a multiple column report where I want to have two groups, one that forces a page break, and one that forces a column break.  I can set this just fine.  But what happens is when I get the page break, the data prints in the second column of the report and the first column is blank.  Is there a way to suppress the column break after a page break?
A.  What you need to do is to set the 2nd group's ForceNewColumn property to false the first time the group is printed on each page.  Then set it back to true to handle the reset of the page.  Set the property to false in the report's OnStartPage event, which gets called at the start of each page.  In the AfterPrint event of the group band, set the property to True so it will work the next time it's called on that page.
------------------
Q.  I am interested in adding the capability of generating mailing labels to my current application.  I could not find any information about mail labels in your documentation.
A.  Doing labels is pretty straight forward.  You set the detailband's height or Size.Height properties to fit the height of your labels and then set the report's Page.Columns property to the number of labels that would go across the page.  You may need to adjust the top and bottom margins of the page to fit your labels.
------------------
Q.  Is there a way to make QReports print columns Left to Right - Top to Bottom instead of Top to Bottom - Left to Right?
A.  There is sample code showing how to do this at www.quickreport.co.uk in the FAQ section.
------------------
Q.  When I do a multiple column report, the detail bands print on the same line as the group bands
A.  Group bands are the same width as the detail bands and since the columns go down then across, it is possible to have detail bands at the same vertical position (different horizontal position) as group band.  If you want column headers to stay above the detail bands, use the page header to store the header fields.
------------------

[NeedData]
==========
Q.  How can I update the progress display when I use OnNeedData to populate the report?
A.  You can set the report's QRPrinter.Progress property in the report's OnNeedData event.  The value should be in the range of 1 to 100.
Example: QuickRep1.QRPrinter.Progress := (Longint(CurrentIndex) * 100) div MyTotalCount;
------------------
Q.  How do I use the OnNeedData event?
A.  When you define this event, it will get called to see if a new detail line is needed.  It has a boolean variable named MoreData.  Set it to true if you still have data and false when you are done.  The QR3DEMO project on our download page has examples of how to use this.

See also 'Abstract table'.
------------------
Q.  I am using the onNeedData event to fill a report, and I noticed that the last "record" doesn't show on the preview, and it doesn't print.
A.  In your OnNeedData event, are you setting MoreData to false on the last record?  That would suppress the last record, you want to set MoreData to false in the OnNeedData event that gets called after the last detail band has printed.
------------------
Q.  How can I build a report with data that doesn't come from a BDE table or query?
A.  QuickReport was designed to work with BDE datasources, but it can use data from other sources via the abstract table or OnNeedData events.  There is sample code at www.quickreport.co.uk.
------------------
Q.  The output from preview is correct, but printing from the preview does not print all of the data or the data has values from the last run of the report.
A.  If the problem is only when you print from a preview, then you will need to reset your data (datasets and/or variables) in the BeforePrint event of the QuickReport.  This event gets called whenever the report needs to be generated.
When the report is regenerated, sometimes you will have to reset your dataset.  One example is if the dataset has a memo and you are connected to a SQL database server like Oracle.  The problem seems to be in the BDE's BLOB caching.
Another situation would be if you are using OnNeedData and that event is controlled by a variable that needs to be initialized at the start of the report.
------------------


[Paper size issues]
==================
Q.  If the Quickreport.Page.TopMargin is to small then the Top of the Quickreport is not be printed.  Quickreport should tell the user that the Quickreport is out of printable range
A.  This is being considered for a future release.
------------------
Q.  How do I set the paper size?
A.  For detailed information about setting the paper size, please refer to the section on Paper size and Margins (page 2-21) in the QuickReport 2 manual. This manual comes with QuickReport under the filename qr2.doc.
------------------
Q.  How do I determine the default paper size of the selected printer?
A.  The following code checks the printer to see what paper size is the default.

with TQRPrinter.Create do
begin
  PrinterIndex := QuickRep1.PrinterSettings.PrinterIndex;
  { for the default printer use the following line }
  PrinterIndex := -1;
  QuickRep1.Page.PaperSize := Papersize;
  free;
end;
------------------

[Preview]
==================
Q.  Is there a simple way to allow the default Preview form to "Save As" something other then a Quick Report format file?  Without creating a new preview screen, I'd like to allow the Save As to save the report either as ASCII or as a comma delimited file.
A.  This is hard coded in the preview form code.  You would have to modify the standard preview or create a new one.  There are sample custom previews on our download page that show to register a custom preview as the new default preview.
------------------
Q.  How can I set the helpcontext values in the preview?
A.  The best way to do this would be to use a custom preview and set the help contexts in that form.  We have sample custom previews on our download page.
------------------
Q.  When I preview a report with a BeforePrint event that returns PrintReport=False, the Preview Form stands empty, with an 0% into its status bar. How can I change the source code to close automatically preview form when no report is generated?
A.  We do not currently have that as a feature, but you should be able to handle it with some code.  You can put code in the BeforePrint to close any open preview windows.
Example:
procedure Tfrmrpt1.QuickRep1BeforePrint(Sender: TCustomQuickRep;
  var PrintReport: Boolean);
var i: integer;
begin
  PrintReport := False;
  if not PrintReport then begin
    Application.ProcessMessages;
    for i := (Screen.FormCount - 1) downto 0 do
      with Screen.Forms[i] do
        if ClassName = 'TQRStandardPreview' then
          Close;
  end;
end;
------------------
Q.  When I have a particular QRPrinter object, e.g QRPreview1->QRPrinter, is it possible to obtain a pointer to the QuickRep that is being previewed/printed?
A.  With QuickReport 3, the qrprinter.Master property is a pointer back to the report that generated the report.  This property will be nil if you load a saved report.  The QR3RNGD4.ZIP demo on our download shows one way how to use this property.
------------------
Q.  I create my reports using this method:
  QuickReport.Prepare;
  QuickReport.QRPrinter.Preview ;
  QuickReport.QRPrinter.Free;
  QuickReport.QRPrinter := nil;
Now the navigation buttons in the print preview do not work.
A.  When used with Prepare, the Preview method returns immediately.  This code would have freed the data being used by the preview.  The Free and Nil lines should be removed.   If you want the code to wait until after the preview has executed, just put a wait loop that waits until the qrprinter has been freed:
Example:
  repeat
    Application.ProcessMessages
  until QuickRep1.QRPrinter = nil;
------------------
Q.  In Quick Report 3, Composite Reports do not have an "OnPreview" event.  Is there a way to use TQRPreview with Composite Reports?
A.  The OnPreview event was left in for compatibility with Quick Report 2.  With Quick Report 3, it is very easy to register a custom preview as the default preview for all reports.  There are detailed examples of how to do this in the QR3MDID4.ZIP and QR3RNGD4.ZIP demo projects on our download page.
Example code from the demos..
type
// To have a custom preview be used as the default preview,
// you first define an interface class.  You will provide two
// functions for this class, Show, and ShowModal.
// don't forget to add qrprntr to the uses clause of this unit.
  TQRSimplePreviewInterface = class(TQRPreviewInterface)
  public
    function Show(AQRPrinter : TQRPrinter) : TWinControl; override;
    function ShowModal(AQRPrinter : TQRPrinter): TWinControl; override;
  end;
implementation
function TQRSimplePreviewInterface.Show(AQRPrinter : TQRPrinter) : TWinControl;
begin
  Result := TPreviewForm.CreatePreview(Application, AQRPrinter);
  TPreviewForm(Result).Show;
end;

function TQRSimplePreviewInterface.ShowModal(AQRPrinter : TQRPrinter) : TWinControl;
begin
  Result := TPreviewForm.CreatePreview(Application, AQRPrinter);
  TPreviewForm(Result).ShowModal;
end;

To specify this preview as the default, you would call the RegisterPreviewClass with the type of preview to register:

RegisterPreviewClass(TQRSimplePreviewInterface);

If you are using custom previews designed with Quick Report 2, there were changes made to how the preview's FormClose event works.  Please see the standard preview's FormClose code.  If you use the Quick Report 2 Preview's FormClose code, it will not free the qrprntr object created by the report.
------------------
Q.  Is there a way to close any open preview forms through code?
A.  You can loop through the list of forms and find each preview form by the class name and then close it.
Example:
  for nIdx := (Screen.FormCount - 1) downto 0 do
    with Screen.Forms[nIdx] do
      if ClassName = 'TQRStandardPreview' then  <-- Substitute or add your class for custom previews
        Close;
------------------
Q.  How can I implement a modal preview? The standard preview isn't modal, when the user make it smaller and click on another form the preview form is hidden. Is there a way to show the preview modal?
A.  QuickReport 3+ has some additional preview methods, PreviewModal and PreviewModeless.  These two methods run in a thread and can not be used with non-thread safe database drivers (like SQL Links).  This limitation will be addressed in a future release.
------------------
Q.  Is it possible to set preview "Fit To Page" as default when opening the preview of a report ?
A.  You can modify the source code for the default preview, or build a custom preview that has this behavior.  We have a sample project for custom previews on our download page that shows how to specify the starting zoom setting for the preview.
------------------
Q.  When repeatedly previewing a report and closing BEFORE the first page is displayed, there is a access violation.
A.  If you are using a custom preview, you must make sure that you have set the qrpreview's qrprinter property to nil when you close the preview.  If you are repeatedly calling preview or print, you may to add code to check the report's state property.  When it's set to qrAvailable (defined in quickrep.pas), then the report is safe to call.
------------------
Q.  Can I preview only selected pages?
A.  There isn't any easy way to preview a range of pages.  As each page is rendered, the preview is notified that the page is now available.  You could have to modify the report to stop after a certain page, but there isn't any way to tell the preview to start at a specific page.
------------------
Q.  Why doesn't the printersetup button work from the preview when I load a saved (.QRP) report?
A.  This is actually a design feature.  When the orientation or paper size was changed, the result was poor output from the saved repots so this functionality was removed from the default preview.  If you build a custom preview, you can use the printersetup on saved reports.  Example projects with a custom preview with this functionality can be downloaded from our download page under the filename custprev.zip (QuickReport 2) and QR3CSTD3.ZIP (QuickReport 3)
------------------
Q.  We've a problem with QRPrinter.PageCount. We've created our own Previewform and when we call QRPrinter.PageCount we always get 0. What's wrong??
A.  You need to specify the preview's qrprinter, otherwise the global qrprinter will be used.  Also, the total page count is not known when the preview is first shown, you must use the preview's OnPageAvailable to update the page count as each page is rendered.
Example:
procedure TfrmPreview.QRPreviewPageAvailable(Sender: TObject;
  PageNum: Integer);
begin
  if PageNum = 1 then
    Caption := QRPreview.QRPrinter.Title + ' - 1 page'
  else
    Caption := QRPreview.QRPrinter.Title + ' - ' + IntToStr(PageNum) + ' pages';

  case QRPreview.QRPrinter.Status of
    mpReady: Caption := Caption + ' READY';
    mpBusy: Caption := Caption + ' BUSY';
    mpFinished: Caption := Caption + ' FINISHED';
  end;
end;
------------------
Q.  If I change the Paper Size in the Printer Setup of the preview, the report does not reflect the size selected.
A.  This is a known issue and will be addressed in a future release.  The work around would be to provide a selection of available page sizes to user before you run the report and the set the report's Page.PaperSize property to paper selected.
------------------
Q.  My custom preview does not use the zoom value that I set at design time, how do I get it to start up with the value that I want?
A.  When the QRPreview is created, it defaults with a zoom value of 100, you'll need to set the value after you create the QRPreview.
------------------
Q.  How can I augment the preview's print function to display a dialog box after the report prints?
A.  The default preview wont let you do this, but if you create a custom preview for your report, you can call the dialog after printing.
An example print button event could look like this:
procedure TfrmPreview.PrintClick(Sender: TObject);
begin
  Print.Enabled := False;
  QRPreview.qrprinter.Print;
  Print.Enabled := True;
  MessageDlg('Did we print?', mtconfirmation, [mbOk], 0);
end;
------------------
Q.  How can I determine the number of pages in my report before I preview or print it?
A.  If you call the report's Prepare method, it will generate the report without printing or previewing it.  After Prepare has finished, the pagecount will be in the report's qrprinter.pagecount property.  Please refer to the manual topic on Prepare for more information.
Example:
    QuickRep1.Prepare;
    QuickRep1.ReportTitle := 'This report has ' +
      IntToStr(QuickRep1.QRPrinter.PageCount) + ' pages';
    QuickRep1.QRPrinter.Free;
    QuickRep1.QRPrinter := nil;
    QuickRep1.Preview;
------------------
Q.  How can I have my custom preview print a range of pages without going through the printersetup dialog?
A.  What you need to do is to add a public property of your preview form of type TQuickRep like the following:

type
  TfrmPreview = class(TForm)
    QRPreview: TQRPreview;
    .....
  public
    { Public declarations }
    CurrentReport : TQuickRep;
  end;

In the OnPreview event of the report, you would use something like:

procedure TfrmMyReport.QuickRep1Preview(Sender: TObject);
begin
  with frmPreview do
  begin
    CurrentReport := QuickRep1;

    QRPreview.QRPrinter := TQRPrinter(Sender);
    Show;
  end
end;

That lets you reference the calling report through the preview's CurrentReport variable.  Then to print out a range of pages with out going through the printer setup, you would do something like the following:

  with CurrentReport.PrinterSettings do
  begin
    { To set your own printer }
    PrinterIndex := MyDesignatedPrinterIndex;

    { set the page range }
    FirstPage := MyDesignatedFirstPage;
    LastPage := MyDesignatedLastPage;
  end;
  QRPreview.qrprinter.Print;

With Quick Report 3, the Master property of the qrprinter is the report that owns it.
------------------
Q.  I can't get the cursor to display as an hourglass during custom preview processing.
A.  This is a known issue and will be addressed in a future release
------------------
Q.  I am using custom preview and want to know if there is an easy way to know when the report is done being generated?
A.  When the report is done, the preview's qrprinter.status property will be set to mpFinished.  The following code will display the title, total pages, and status as the preview caption when used as the preview's OnPageAvailable event.

procedure TfrmPreview.QRPreviewPageAvailable(Sender: TObject;
  PageNum: Integer);
begin
  if PageNum = 1 then
    Caption := QRPreview.QRPrinter.Title + ' - 1 page'
  else
    Caption := QRPreview.QRPrinter.Title + ' - ' +
     IntToStr(PageNum) + ' pages';

  case QRPreview.QRPrinter.Status of
    mpReady: Caption := Caption + ' READY';
    mpBusy: Caption := Caption + ' BUSY';
    mpFinished: Caption := Caption + ' FINISHED'; { <-- all done }
  end;
end;
------------------
Q.  Why in report preview mode, does the CPU usage for the quick-reports application go to 100%
A.  This was a known issue and was addressed in the 2.0j release.
------------------
Q.  My custom preview doesn't work the way it did with QR1
A.  The preview must be called with Show instead of ShowModal.  This a change from the QuickReport 1 behavior, but is required for QuickReport 2.  We are considering adding a modal preview for QuickReport 3.0
------------------
Q.  Why wont the progress bar work properly with non-BDE reports?
A.  QuickReport 2 checks the TTable or TQuery for the current record number and the total number of records.  These two values are used for displaying the progress bar percentage.  SQL based queries and non-BDE data have no way of telling QR2 what the total number of records is, which is why the progress bar does not update for those kinds of reports
------------------
Q.  Some computers do not display a report and others work fine.
A.  We have seen that happen on machines that do not have a default printer defined.  Without a default printer, QR has no way of knowing how to render the report.
------------------
Q.  When the preview method of a report is called, it looks like the report is being painted twice and there is some flicker
When a form is created the event handlers are executed in the following order:
   OnCreate   OnShow   OnPaint   OnActivate   OnResize   OnPaint again
A.  This is a known issue and will be addressed with a future release.
------------------
Q.  In QR1, I could disable/hide the save, print and load report speed buttons in the preview. Is this no longer an option?
A.  This is not an option with QuickReport 2 (or later).  You would have to create a custom preview and build it with only the functionality that you require for your application.  We have examples on our download page of custom previews for both Quick Report 2 and Quick Report 3
------------------
Q.  Some lines do not appear in the preview, but they appear in the printout.
A.  The report is rendered to a TMetafile object when it is sent to the preview.  Depending on the zoom value of the preview, the scaling of the TMetafile may crop out some of the lines.  If you zoom in (you may need to use a custom preview to zoom in close enough), the lines will reappear.
------------------
Q.  How can I tell in BeforePrint if I am Printing or Previewing?
A.  In the report's BeforePrint event, you can check the value of the report's QRPrinter.Destination property.  If it's set to qrdMetafile, then it's rendering the preview.  If it's set to qrdPrinter, then it's rendering the report directly to the printer.  This only works when you are generating a report, if you load a saved report, the destination will always be qrdMetafile.
------------------
Q.  Is there a way to tell QuickReport that when you generate a preview, you only want the preview to span a certain number of pages or have a starting/ending page number?
A.  You can't tell the preview to start at a specific page, but you can get it to stop after a specified number of pages.  You can use the OnEndPage event (documented in the manual) to get the report to stop processing after the specified number of pages.  If you do this an extra blank page will be generated, there isn't much you can do to get around that.  The following example shows how to stop the preview after only 32 pages without affecting the number pages when you print from the preview:

procedure TfrmSomeReport.QuickRep1EndPage(Sender: TQuickRep);
var
  nIdx: integer;
begin
  {
  This code will only take affect when previewing, you will need to
  add qrprntr to the uses clause.
  }
  if QuickRep1.QRPrinter.Destination = qrdMetafile then
    if QuickRep1.PageNumber = 2 then
    begin
      {
      Disable the printing of all bands, requires 2.0J or later.
      If you do this, remember to re-enable the bands in the reports
      BeforePrint event the next time you run the report.
      }
      for nIdx := 0 to QuickRep1.BandList.Count - 1 do
        TQRCustomBand(QuickRep1.BandList[nIdx]).Enabled := false;

      {
      Tell the report that we are done reading data.
      }
      QuickRep1.qrprinter.cancel;
    end;
end;

Make sure to have the following code in the report's preview to re-enable the bands again.

procedure TfrmSomeReport.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
var
  nIdx: integer;
begin
  for nIdx := 0 to QuickRep1.BandList.Count - 1 do
    TQRCustomBand(QuickRep1.BandList[nIdx]).Enabled := true;
end;
------------------

[Printing and PrinterSetup]
==================
Q.  I am losing data when I print.
A.  Some printer drivers have trouble printing a full page of data from QuickReport.  There are a few settings that can be changed in the printer driver that can resolve this problem.
Go to the properties dialog for the printer driver to which you are sending the form.  Then go to the details page and then select the spool settings. Check the Spool Data Format.  If you have a choice between EMF and RAW, try swapping the settings.  If EMF is available, it uses less memory than RAW.
Changing the graphics mode in the printer driver from HPGL/2 or Vector to Raster may help if your particular driver offers that choice.
If the driver has a page protect option, selecting that option will help
Lowering the printer resolution DPI can also help.
Also try setting "Disable bi-directional support for this printer".  If you had "Enable bi-directional support for this printer" set and your port or your cable was not bi-directional capable, you could have problems printing.
Another thing to check would be the printer port settings in the BIOS.  If the port was set to ECP, try changing it to EPP or standard.
Another possibility is that the printer cable is not fully compliant with the IEEE standard and your need to upgrade it.
------------------
Q.  My users can't print under NT 4, but I can as the administrator.
A.  The following was taken from Hp's tech support web site, use at your own risk.
Windows NT 4.0 has the ability to control access to the hard drive by using NTFS. This local hard drive security is not available if the system is using a standard file allocation table (FAT). When the default NTFS permissions are changed to lock the system, the user may have difficulty accessing the printer. Usually the system administrator can print to the printer without any problems, but when a user logs into the system and tries to print, error messages appear and the printer fails to respond. This is often caused by the user not having the appropriate permissions to access the necessary files for the print operations. A system administrator must change the permissions to allow the user access to these files.
The following steps may provide a workaround without the System Administrator making any changes to the system security settings.
1. Select Start, Settings, and then Printers.
2. In the Printers folder, right-click the specific printer icon.
3. Verify that Default printer is checked and then click Properties.
4. Select the Securities tab, and then click the Permissions box in the Permissions window.
5. Set the permissions level, as shown below for each item.
  a. Administrators--Full Control
  b. CREATOR OWNER--Manage Documents
  c. Everyone--Manage Documents
  d. Power Users--Manage Documents
6. Set the level by selecting the name; then, using the down arrow in the Type of Access window, select the Access level.
7. This should enable users to print without errors.
------------------
Q.  I am trying to print a report on a HP5P using a top margin of 4mm, but only the first page comes out.
A.  We have had reports of a problem with the driver for the HP5P where it could not handle that margin size.  The work around would be to use the HP6 driver with this printer.
------------------
Q.  The report title is being truncated in the Windows Print Manager.
A.  This is not a QuickReport bug, it is a VCL bug.  If you look at the source code, we define the ReportTitle as string.  It gets passed to the TQRPrinter.Title property, which is also defined as string.  We pass that the TPrinter.Title property and it gets used in TPrinter.BeginDoc where it passed to CTitle, which is an array of 32 bytes.  This issue was addressed in Delphi 5.
------------------
Q.  When I set the page range the report continues processing until I press cancel. Only the pages selected print and that is what I want, but why does it continue to process?
A.  That is a limitation of the current design of QuickReport and will be addressed in a future release.
------------------
Q.  We are trying to print reports in TEXT mode (in a dot matrix printer). When we use the Generic/Text Only printer from Windows it works, but it only prints the first 80 characters of each row. What can we do to print all the characters from the row?
A.  That is the designed behavior of the Generic/Text Only printer driver.  It truncates the text at to size of the paper.  If you use a wider paper size (like Ledger), you may be able to get more of the text.
------------------
Q.  Is there any way to prevent QuickReport from doing a page eject (form feed) at the end of a page or print job?
A.  As long as you use printing via the windows printer driver (TPrinter and TQRPrinter both use this) there is no way to avoid the page eject after the print job has finished. This behavior has been built by MS into the printer driver design, for a good reason. The system has to be able to deal with several apps running in parallel printing all to the same printer and it assumes that each job starts on a new page.

Q.  When you look in the queue for a print job, Quick Report print jobs have no name.  How can I give a Quick Report printout it a name for the queue?
A.  Did you set the ReportTitle property of the report?  This gets passed to the TPrinter object when you print and that value will be used as the name of the print job.
------------------
Q.  I have a PC with a HP692C deskjet printer as default and when I try to print QuickReport raise the error : Printer index is not valid. Only with this printer.
A.  This message doesn't come from QuickReport, it comes from the Delphi printers unit.  You can get this message if you try to specify a printer option that the printer driver does not accept.  If you copy the printers unit (if you have the VCL source code) to your project directory and add it to the project, you put break points in it to see which setting is causing your problem.
------------------
Q.  I get a printer error when I print a range of pages.
A.  There is a known problem where a range of pages will cause an error when you have controls that cause a band to stretch.  The length of a band that stretches is not known until the band is actually printed.  If pages are skipped, the page count is off and report throws an error.  This will be addressed in a future release.
------------------
Q.  I am setting the control's font to Arial but it is printing as Courier (or vice versa).
A.  Check the control's Font.Pitch property.  If you select Arial and set the pitch to fpFixed, Windows will substitute the closest match that supports that pitch.
------------------
Q.  I can't get the Bin Selection for quick reports to work. No matter what I try, everything goes to the same bin. How do you select output bins?
A.  You should be setting the report's PrinterSettings.Outputbin property to the bin that you want to use.  Only the bins listed on the manual page for the outputbin property (5-121) can be selected.  Device specific bins are not supported at this time.  If the printer's default bin is a device specific bin, you may have to set to another bin in order for QR2 to be able to select a bin.
------------------
Q.  I am trying to layout my report to print using the Generic/Text Only driver, but I am having trouble getting the text to line up and blank lines get inserted into the printout.
A.  This is what I do when I am designing a report for the Generic/Text only driver.

Set the report units to Characters.
Set the report font to 'Courier New' and the size to 10.
Set the height of the band to slightly less than the height of the text controls.  The default height of the QRDBText control is 17 when I use these settings.  I set the detailband height to 16.  This should eliminate any extra blank lines from the output.
------------------
Q.  I don't see the progress window during the print when I use:
myreport.quickrep1.Prepare;
myreport.quickrep1.QRPrinter.Print;
myreport.quickrep1.QRPrinter.Free;
myreport.quickrep1.QRPrinter := nil;
How do I enable the progress window using the above code?
A.  The progress windows is not applicable to that method as the report is not being generated at print time.  The report was rendered to a metafile with the prepare method and the print method is just copying the metafile to the printer.
------------------
Q.  I'm getting a 'Printer is not currently printing' error when I try to print a report, I have not been able to find a reason for this, it only happens with certain reports. (Others print without problems)
A.  Check the report.printersettings.FirstPage and the report.printersettings.LastPage properties.  If they are set to values outside of the number of actual pages in the report, you will get this error at runtime.
------------------
Q.  The printout doesn't match the preview exactly.
A.  We use Windows API calls to get the font height and width information back and some fonts do not return the correct information.
------------------
Q.  I have a report that prints fine on a HPIII printer but not on the HP4.  Either the text is missing, or the bands print black.
A.  There have been many reports of problems with the HP4 (and HP5) printers.  You should make sure that you are using the current driver from HP's web site (http://www.hp.com/cposupport/jsnav/prhome.html).  You may also need to check the page protect option in the printer driver and/or set the DPI to 300.
------------------
Q.  The output from preview is correct, but printing from the preview does not print all of the data or the data has values from the last run of the report.
A.  If the problem is only when you print from a preview, then you will need to reset your data (datasets and/or variables) in the BeforePrint event of the QuickReport.  This event gets called whenever the report needs to be generated.
When the report is regenerated, sometimes you will have to reset your dataset.  One example is if the dataset has a memo and you are connected to a SQL database server like Oracle.  The problem seems to be in the BDE's BLOB caching.
Another situation would be if you are using OnNeedData and that event is controlled by a variable that needs to be initialized at the start of the report.
------------------
Q.  How can I tell how the user exits the report's PrinterSetup method?  It does not pass back the status.
A.  You can test the value of report's tag property (with version 2.J or newer) after calling PrinterSetup and if it's 1, then they selected OK.
Many users have asked for the ability to print automatically if the user selects OK from PrinterSetup.  You would code that like this:

  with frmReport.quickrep1 do
  begin
    PrinterSetup;
    if tag = 0 then
      print;
  end;

To do this in the preview will require using a custom preview and passing in a reference to the calling report to the preview.  That will allow you to call PrinterSetup and be able to check the tag value.  We have a sample preview that does this and it is available upon request.
------------------
Q.  How can I check to see if the user cancelled the printing of a report?
A.  You can use the AfterPrint of the report to set a flag as it will only get called if the report prints to completion.
A.  (QR3) The report has a Cancelled property that gets set to True if the user cancels a report (preview only, not the printout).
------------------
Q.  How do I determine the paper size of the printer at runtime?
A.  If you use the following code before you call your report, you can specify the default size:
with TQRPrinter.Create do
begin
  Printerindex := -1;
  QuickRep1.Page.PaperSize := PaperSize;
  Free;
end;

This assumes that you are using the default printer and your report is named QuickRep1.
------------------
Q.  After calling QuickRep.PrinterSetup to pick a specific printer, what's the best way to get the name of the printer that was just chosen?
A.  The printerindex is stored in the report's printersettings.printerindex property.  The following example will set the form's caption to the current printer for the selected report:

  with TfrmReport.Create(Application) do
  begin
    QuickRep1.PrinterSetup;
    self.caption := printer.printers[QuickRep1.printersettings.printerindex];
    QuickRep1.Preview;
    Free;
  end;
------------------
Q.  I can not get the PrintBackground to work. In the preview sample I added a menu with the code:
procedure TMain.PrintBackground1Click(Sender: TObject);
var
  aForm : TReport1Form;
begin
  Application.CreateForm(TReport1Form, aForm);
  aForm.QuickRep1.PrintBackground;
  aForm.Free;
end;
When the PrintBackground method is called an exception is raised.
A.  You are freeing the report while it is printing in the background.  You can't free the report until it has finished printing.  The following example creates a report, calls PrintBackground, and then waits until it has finished before freeing the report:
Application.CreateForm(TfrmGroupTest, frmGroupTest);
with frmGroupTest do
begin
  QuickRep1.PrintBackground;
  while QuickRep1.QRPrinter.Status <> mpBusy do
    Application.HandleMessage;

  while QuickRep1.Available = False do
    Application.HandleMessage;

  Free;
end;
------------------
Q.  I'm trying to write a report that gets printed to the windows generic text-only printer driver.  Some lines move around when it is actually printed.  Do you have any ideas?
A.  Try setting the report's font to "Courier New" at size 10.  Then set the height of the band to 16 and if that cleans up the output.  To save paper while testing this, set the printer driver's destination to "FILE:"
------------------
Q.  How can I send control chars to the printer with Quickreport?
A.  QuickReport uses the Windows printer driver GDI calls to output data, it does not support sending escape codes directly to the printer.  You could use the ASCII text export filter to save the report as text.  You would then insert your printer escape sequences into that file and then copy that file to printer port.
------------------
Q.  I can't set the printer at runtime, I get an exception if I use the following syntax:
Quickrep1.Printersettings.printerindex := Quickrep1.printer.printers.Indexof('HP LaserJet 4 on LPT1:');
A.  QuickReport does not create it's printer until it needs it,
you'll need to use a regular printer object that Delphi will initialize for you.
the following code will work:
Quickrep1.Printersettings.printerindex :=printer.printers.Indexof('HP LaserJet 4 on LPT1:');
------------------
Q.  How can let the users select the printer before running the report?
A.  If you call the Report's PrinterSetup method, this will set the printer settings for the report before you run it.  You could do it like:

  with frmReport do
  begin
    QuickRep1.PrinterSetup;
    QuickRep1.Preview;
  end;
------------------
Q.  I retrieve the values of the Delphi PrinterSetupDialog and when I use the printerindex returned by it, I get the error: PRINTER INDEX OUT OF RANGE
A.  There is a bug in the Delphi printer setup dialog that causes it to create new
instances of printers in the printer list.
QuickReport 2.0i (and later) includes a fixed printer dialog in the qrprnsu unit.
Please use that instead of Delphi's dialog.
------------------
Q.  When I change the printerindex, I can't select the right paper size.
A.  There is a problem in the printers unit where when the printerindex index is changed,
the new printer "inherits" the properties of the previous printer.
With the 2.0j release, we now reset the printer driver when the printerindex is changed.
------------------
Q.  When I use Printer Settings from within QuickReport, it suggests me to write out all
10000 pages, even though my report contain only 10-15 or so...
A.  This is a cosmetic bug (the report will never print out anything past the last page) and this will be fixed in a future release.
------------------
Q.  I can't select a tray for HP printers
A.  The printer dialog QuickReport uses is a standard print setup dialog. QuickReport defaults to the Default tray defined in Windows. I believe the problem with some printer drivers (LJ5/6) is that they try to redefine the tray order. We will look for a solution to this for a later version.
One work around is to use the LaserJet III driver when printing with QuickReport.
------------------
Q.  How do I the printer properties if I use my own printersetup dialog box?
A.  Please see the TQuickRep.PrinterSetup method in quickrpt.pas for code showing how to set the printer to what was selected in the setup dialog.
------------------
Q.  I get an extra blank page when I print a range of pages.
A.  The extra blank page problem was addressed in the 2.0k release.
------------------
Q.  Why do the Properties QRPrinter.Canvas.TextHeight and TextWidth return always zero value when running in 16 bits?
A   The QRprinter.Canvas is a standard metafile in Delphi 1 and a standard metafile doesn't support these functions. Enhanced metafiles in Delphi 2/3 does.
------------------
Q.  The report prints under Win95 but not under Win 3.1
A.  This is probably a printer driver problem even though they use the latest driver. A possible solution might be to try to blank the QRPrinter.OnGenerateToPrinter event to see if that helps.
A workaround is to clear the QuickRep.QRPrinter.OnGenerateToPrinter event, setting it to NIL when the preview is brought up. This will force QR to print the generated metafiles instead of generating the report all over directly to the printer. The down side is that you might experience a slight scaling of the report page and that images might have a lower resolution.
------------------
Q.  When I use printer fonts, the preview does not match the print out.
A.  A possible solution to this problem is to assign the printer specific font to your report at runtime. If you use the same font for all controls in your report you should be able to say

QuickRep.Font.Name := 'Your font name'

before starting your report. If Windows is able to a reasonably good substitution it should work.
------------------
Q.  When I use the QRPrinter object, the scaling is off
A.  There are some known problems with using the QRPrinter object in this way.  With the 2.0h release, we have added a new class, QRPrintJob, which is a wrapper for the QRPrinter object.  This code is in the \quickrep\demos\qrprntr directory and makes it easier to do code like what you sent in.
------------------
Q.  When i use the EPSON LQ-1070+ printer driver  the program closed, no error message
A.  There is a known problem with using QuickReport with printers that support more than 64 different page sizes.  This will be addressed in an upcoming release.  At the present time, there is no work around, short of using a generic Epson compatible printer driver.
------------------
Q.  When I print my reports under NT 4, the font changes are not working correctly.
A.  There is a known printing problem with Windows NT 4.0 when you have multiple font changes on the printer canvas.  Installing the Service Pack 3 to NT should solve the problem.
------------------
Q.  I get a exception error when running our application on a machine without a default printer.
A.  QuickReport requires that a default printer be installed.
The report is prepared using information from the printer driver.
The following code shows one way to check and see if a default printer has been defined.
procedure TfrmReport.btnReportClick(Sender: TObject);
var
  FDevice:     PChar;
  FDriver:     PChar;
  FPort:       PChar;
  FHandle:     THandle;
  CurrentPrinterName: string;
begin
  GetMem (FDevice, 255);
  GetMem (FDriver, 255);
  GetMem (FPort, 255);
  Printer.GetPrinter (FDevice, FDriver, FPort, FHandle);
  CurrentPrinterName := FDevice;
  if FDevice <> nil then FreeMem (FDevice, 255);
  if FDriver <> nil then FreeMem (FDriver, 255);
  if FPort <> nil then FreeMem (FPort, 255);

  if CurrentPrinterName <> '' then
    { Preview the report }
    QuickRep1.Preview
  else
    MessageDlg('You do not have a default printer defined.' +
               #13#13 + 'Please select a printer before running a report.',
               mtError,[mbOK],0);
end;
------------------
Q.  How do I print to a printer different than the Windows default printer?
A.  Set QuickRep.PrinterSettings.PrinterIndex to a value corresponding to the printer you want to print to. This value is the same as for the Delphi TPrinter.PrinterIndex. Set to -1 to print to the default printer again
------------------
Q.  I have some easy reports very simple ones (without graphics), but in a matrix printer they are printed very slowly. Is there a way to print them like the DOS programs did in PRINT, and TYPE filename.ext > PRN?
A.  QuickReport renders a report to the printer driver's canvas.  It doesn't really have a text mode for printing, rendering the pages is left completely up to the printer driver.  If the printer driver has a draft mode setting, try making that setting the default.  You can also try using the "Generic / Text Only" printer driver that comes with Windows.  You may have to modify the fonts and/or control placement with the report to get satisfactory results with this driver.
------------------
Q.  I would set to specify a default printer to be used for multiple reports.
A.  You have to add the code to determine what the printerindex value is for the printer.  Then set the QuickRep1.PrinterSettings.PrinterIndex property to this value for each report before you call the print or preview methods
------------------
Q.  My report only prints one page, but the design time preview shows all pages.
A.  Check the report's PrinterSettings.FirstPage and PrinterSettings.LastPage properties and make sure that they are set to 0.  If you print a range of pages from the design time preview, these two fields may get set to the values that you had selected.
------------------
Q.  How can I print multiple copies of a report without having to generate it over and over again?
A.  You would set the report's PrinterSettings.Copies property to the value that you want.  Not all printer support this property.

Another way to print multiple copies is to use the prepare method instead of calling the print method directly.  For example:

Instead of:
  with TfrmQR.Create(Application) do
  begin
    QuickRep1.Print;
    free;
  end;

Try:
  with TfrmQR.Create(Application) do
  begin
    QuickRep1.Prepare;
    QuickRep1.QRPrinter.Print;  { print first copy }
    QuickRep1.QRPrinter.Print;  { print second copy }
    QuickRep1.QRPrinter.Free;
    QuickRep1.QRPrinter := nil;
    free;
  end;

This method generates the report to an internal metafile and then rendered report is sent to the printer twice.
------------------
Q.  I am getting printer overrun errors with some reports when I print to my laser printer
Q.  Some reports are printing dark bands on my laser printer.
A.  These problems can happen when you send a full page to a laser printer and that printer does not have enough RAM to print a full page at the specified DPI.  Try reducing the DPI or adding more RAM to the printer.
------------------
Q.  When I call the printersetup dialog, it always shows the default printer, even if I have preset the printerindex to another printer.
A.  This is a bug in Borland's dialog, it always comes up with the default printer no matter what the printerindex is set to.
------------------

[QREditor]
==================
Q.  I am having a problem using TQREditor. If I drop this component on a form and try to run, it says: File not found qrwizard.dcu.
A.  The Delphi 3 installer for QuickReport 3.0.5 failed to copy that file in, you can copy it from the quickrpt directory.  You may need to copy the qrwziard source code to your project first so that it can compile the .dcu file.  After the qrwizard.dcu file has been compiled, you can move that file and the qrwizard.dfm file to the Delphi \lib directory.
------------------
Q.  The hints for the controls on the TQREditor do not show up.
A.  Set the ShowHint property of the parent component (usually a form) of the TQREditor component to true.  Your hints should now show up.
------------------
Q.  Can I manually edit a QREditor (.qr) file with a text editor?
A.  You can convert the .qr file to and from a text file by using the ObjectBinaryToText() and ObjectTextToBinary() methods.  The QREditor demos for QuickREport 3 on our download page have example code for this.
------------------
Q.  I get an access violation if I set the QREditor's ShowMenu property to true.
A.  This a limitation of the current code and will be addressed in a future release.  The work around is to set this property to true at runtime.
------------------
Q.  How do I master/detail reports in the QREditor?
A.  This was added in the 3.0.5 release.  You define the master table using the "Report data setup" dialog.  The bottom panel of this dialog allows you to define a detail table and link it to the master table.
------------------
Q.  I want to be able to execute a report made in "QREditor" (*.qr) without using the QREditor.  How can I do this so the user can not edit the report?
A.  You can load a qreditor report with the QRLoadREport function (defined in the qrextra unit).  Remember to add the qrextra unit to your uses clause.  The following code shows how load, preview, and finally free a saved report:
procedure TfrmTest.btnQRLoadReportClick(Sender: TObject);
var
  MyReport: TQuickRep;
begin
  try
    MyReport := QRLoadReport('myreport.qr');
    MyReport.Preview;
  finally
    QRFreeReport(MyReport);
  end;
end;
For QuickReport 3.0.5 (or later) you would use a TQREditor object to load the report.
Example:
  with TQREditor.Create(self) do begin
    OpenReportFile('myreport.qr');
    PreviewReport;
    Free;
  end;
------------------
Q.  I'd like to know how to use my QR files made by Delphi 3 with the release of Delphi 1.
A.  The .QR files saved by the QREditor are form description files (.DFM) and DFM files are not downward compatible.  You will need to either create your .QR files with Delphi 1 or manually edit them to remove the properties that are not supported with Delphi 1.
------------------
Q.  How can I send parameters to the QREditor when using a Query?
A.  This is not directly supported in the current release.  What you can do is to load the saved report and modify the query properties.  While you can't pass parameters, you can build an SQL statement with those parameters embedded in the text of the SQL statement.  The following example loads a previously saved report and replaces the SQL property if a TQuery was being used or it sets the filter if a TTable is being used:

QuickReport 2:
procedure TfrmMain.Button1Click(Sender: TObject);
var
  MyEdit: TfrmQREdit;
begin
  MyEdit := TfrmQREdit.Create(Application);
  with MyEdit do
  begin
    show;
    qreditor1.OpenReportFile('cust1563.qr');
    if qreditor1.Report.DataSet is TQuery then
    begin
      with TQuery(qreditor1.Report.DataSet) do
      begin
        SQL.Clear;
        SQL.Add('select * from customer where CustNo=6312');
        Open;
      end;
    end
    else
    begin
      with TTable(qreditor1.Report.DataSet) do
      begin
        Active := False;
        {$ifdef win32}
        Filter := 'CustNo=6312';
        {$endif}
        Active := True;
      end;
    end;
    qreditor1.Report.Preview;
    Close; { if you want to make the editor go away after the preview }
  end;
end;

QuickReport 3.0.5: (from the QREditor demo on our download page)
procedure TEdtDemoFrm.btnSalesPreviewClick(Sender: TObject);
var
  EmployeeNumber: integer;
  MyReport: TQuickRep;
begin
  // Prompt the user for an employee number to report on
  if GetEmployeeNumber(EmployeeNumber) then begin
    with TEdtFrm.Create(Application) do begin
      try
        QREditor1.ShowMenu := true;
        QREditor1.OpenReportFile('sales.qr');
        // Get the report variable
        MyReport := TQuickRep(QREditor1.ReportEditor.FormEditor.MainControl);

        // Now update the query
        if MyReport.DataSet is TQuery then begin
          with TQuery(MyReport.DataSet) do begin
            if Active then
              Close;

            // Set the SQL statement.  If the user accidently changes the SQL
            // statement, this will make sure that the correct one is in place
            SQL.Text := 'SELECT OrderNo, CustNo, SaleDate, EmpNo, ItemsTotal, LastName, FirstName '+
                        'FROM orders JOIN employee ON orders.empno = employee.empno '+
                        'WHERE employee.empno = :p0 '+
                        'ORDER BY orders.empno, SaleDate';
            // Pass the selected employee number as the parameter to this report
            Params[0].AsInteger := EmployeeNumber;

            // open the query again
            Open;
          end;
        end;
        // Display the report
        QREditor1.PreviewReport;
      finally
        Free;
      end;
    end;
  end;
end;
------------------
Q.  After pressing the open button on the QREditor and canceling this action the buttons do not return to the original state and the 'new' button is disabled.
A.  The demo editor project shows how to add a menu to the qreditor with ability to re enable the new button.
------------------
Q.  The QREditor's NewImage button is commented out.  When will this be enabled?
A.  This function will be added to a future release.
------------------
Q.  Can I use the PAGE function somehow in TQREditor?
A.  This will be in the 3.0 release (due out in 98)
------------------
Q.  I am interested in the TQREditor component, but I have a question: How can I create a master-detail report through the component?
A.  At the current time, the QREditor component is limited to a single dataset.  This functionality will part of a future release.
------------------
Q.  When working with the QREditor, the Title band does not get previewed nor printed.  All the layout options and the band properties appear to be set correctly, but the band will not preview or print.
A.  Have you defined a dataset for this QREditor report?  If you do not have one, the title band will not be output.
------------------
Q.  Is it possible to bypass the login dialog when I want to report data from a database server with the QREditor? (by providing username and password via code)
A.  With the BDE, you'll need to use a TDatabase component and set the username and password via the params property.  You can't add this to a report created by QREditor, but if you put the component on the same form as the QREditor, this should work.  I tested this with a password protected MS Access database and it worked.
------------------
Q.  I'm using Quickreport editor and I found a problem. If I want to put in a report a label and its caption is the same name of a dataset field's, I can't put this label caption in the report.
A.  This is a known problem and will be addressed in a future release.  One work around is to use a SQL statement to rename the columns in the table so that the names do not overlap.  Example

SELECT OldName AS NewName FROM SomeTable
------------------
Q.  The fields in the QREditor are printing as the field names instead of the values.
A.  When you select a dataset with the editor, it names it either TTable1 or TQuery1.  If you have datasets with the same name, this can cause a conflict with the QREditor where it tries to use the wrong dataset.  Renaming the other datasets removes this conflict.  This will be addressed in a future release.
------------------


[QRLoopBand]
==================
Q.  How can I know on the BeforePrint event of a Loop Band the value of the counter that its going to print?
A.  The Count property of the TQRLoopBand is incremented each time the report goes to print the band.  It is 0 based (0, 1, 2, 3....)
------------------
Q.  What is the TQRLoopBand control?
A.  This is a band that is not connected to any dataset and will print for the number of times that it's PrintCount property is set to.
------------------

[QuickReport 3]
==================
Q.  In QuickReport 3.0.4, the groupfooter with the AlignToBottom property set true will sometimes print over the bottom of the last detailband.
A.  This is an open bug and will be addressed in a future release.  If you set the LinkBand property of the detail band to the group footer band, that should force a page break when there is not enough room for both bands on the same page.
------------------
Q.  How do I change the language of the package?  What files need to be modified in Quick Report 3 and how do I rebuild the packages?
A.  Most of the text strings are defined in qr3const.pas.  A few of the units have text properties set in their .dfm files.

After you change those units, you will need to rebuild the runtime package (qrpt40 for Delphi 4, qrpt43 for Delphi 3).  The qrpt4*.dpk file can be found in the quickrpt directory where the source code was installed.  Close all projects and any program using Delphi runtime packages.  Load the .dpk file and build it.  If you get an error about missing units, just remove those units from the package file.  Then load the design time package, dclqrt40.dpk (or dclqrt43.dpk for Delphi 3).  Rebuild that unit (removing any units that Delphi can not find).

After you rebuild the packages, you will need exit Delphi.  Copy the qrpt40.bpl (or qrpt43.dpl) to your windows system directory.  Copy the design time package dclqrt40.bpl (or dclqrt43.dpl for Delphi 3) to the Delphi bin directory.  Then copy the .dcu and .dfm files to the Delphi lib directory.

The next time you start Delphi, it should be using the recompiled packages.
------------------
Q.  I get an error using QRCreatelist with code that worked in Qr2.
A.  With QR3, the report variable must be of type TCustomQuickRep.
------------------
Q.  Dropping a TQRlabel or another TQRPrintable on a TQuickReport with the property Units set to another value than PIXEL set the values of Top and Left not to the position of the mouse, but to high dummy values like 7418.
A.  This is a known problem if the report is on a form with non-QR visual controls.  Placing the report in it's own form is the work around for this problem.
------------------
Q.  When I set PrintBand to false, the dataset fields for that line are excluded from the TQRExpr functions.  In Quick Report 2, these fields are included in the calculations.
A.  This is a feature that had been requested by many users.  It had been expressed to us that if a band was suppressed, it's data should be excluded from the accumulator functions like SUM().  To emulate the Quick Report 2 code, instead of setting PrintBand to false, set the height of the band to 0 when you want to suppress it and still use it for functions.  Just remember to set the height back to the design time height when you do want to print the band.
------------------
Q.  Every time I preview a report with my custom preview, I lose some memory.
A.  You will want to check your preview's FormClose event.  If you are using code from Quick Report 2, that code may not work correctly.  You may want to compare your close event code with the code used by the standard preview.
------------------
Q.  I can't find the qrbonus unit.
A.  The classes that were the qrbonus unit are now in the qrextra unit.
------------------
Q.  I have a report with some controls on a TQRBand and the preview is empty.
A.  You must have a detail band, this is required for Quick Report 3.  Using reports without detail bands was an undocumented feature of Quick Report 2 and was never supported.
------------------
Q.  (Delphi 3) I am getting an error when I compile with runtime packages enabled.  With out runtime packages, it works fine.
A.  The package list will not get updated automatic when you install QR3 over QR2 and you may have the QR2 runtime package (qrpt30.dpl) on the list instead of the Quick Report 3 runtime package (qrpt43.dpl)
------------------
Q.  I have a report that does not print the DetailBand (DetailBand1BeforePrint() sets PrintBand to False).  With version 2 of QuickReport, SUM() expressions in groups incremented their values whether or not the detail band printed.  In version 3.0.4, it appears that the SUM() expression only increments if the detail band prints.  What can I do to change this behavior back to how version to handled this?
A.  This was actually a change that had been requested by other users.  There is a simple work around that you can use in the BeforePrint event.  Instead of setting PrintBand to False, set the band height to 0.  If you need to restore the height, set the tag property of the band to the height and restore the height from the tag in the band's AfterPrint event.  The report will still think that it printed the band, but the size will be 0 so you will not see the band and your sum will include the data from the hidden records.
------------------
Q.  My users can not see the buttons on the preview's toolbar.
A.  What version of comctl32.dll is on your system?  The preview uses a TToolbar control and that control will not display glyphs from an imagelist when the destination computer has an older version of this dll.   It was compiled for version 4.72.  You have a couple of options.  You can get the free update from MS for the current comctl32.dll, or you can recompile the QR package against the old version of comctl32.dll (not recommended), modify the standard preview in the qrprev unit so that it does not use TToolbar, or you could use a custom preview that does not use a TToolbar control.  We have Custom Preview examples on our download page and with QR3, you can change the preview on a global basis.  There is an MDI demo example on our download page that shows how to do this.
Delphi 4 requires (and installs version 4.72)  You can download the file directly from Microsoft at the URL http://msdn.microsoft.com/developer/downloads/files/40comupd.htm.  It has been reported that this link is no longer valid, an alternative would be ftp://ftp.microsoft.com/softlib/mslfiles/40comupd.exe
If you are using NT 4, make sure that you have at least SP 4 or higher applied to it.
------------------
Q.  With QuickReport 2, I could set OnGenerateToPrinter to nil to keep the report from being regenerated.  How do I do this in Quick Report 3?
A.  The OnGenerateToPrinter property is a QR2 only property, it doesn't exist in QR3.  There are a couple of ways to do this in QR3.  You can set the report.qrprinter.master property to nil in the BeforePrint event of the summary band.  If you don't need a summary band, you can set PrintBand to false in that event.  You could also use a custom preview and change the print button to call the preview's qrprinter.save to a temporary file and then qrprinter.load.  You would then call the qrprinter.print method to print the loaded report.
------------------
Q.  I think I have installed version QuickReport 3 correctly with Delphi 3, and it prints short reports if I call the PRINT command. If I use preview however, I receive a "Control has no parent window error" when I press the print button. I didn't have this problem with Version 2.0K.
A.  The DLL needs a reference to the calling application so that the DLL's forms are children of the application.  Please see the Delphi help page for TApplication.Handle.
------------------
Q.  I am trying to compile a report from QuickReport 2 and I get the message "Undeclared identifier TQRDetailLink."
A.  The TQRDetailLink class was a QuickReport 1 object.  QuickReport 2 had partial support for this control and it was treated as an alias to the TQRSubDetail control.  QuickReport 3 does not have any support for reports that were ported from QuickReport 1.  If you replace the TQRDetailLink controls with TQRSubDetail controls, your report should run like it did under QR2.  The TQRDBCalc control from QR1 will also produce the same error.  This was replaced with the TQRExpr control.
------------------
Q.  I am creating an end user report generator and use the TQRDesigner to enable objects edit and selection functions, but I couldn't find it in the new version.
A.  The TQRDesigner is no longer part of the package, we use the Delphi form designer to edit the report.
------------------
Q.  I have some variables defined in the report's functions property and I can't initialize them in the report's BeforePrint event.
A.  The report's BeforePrint event is called before the elements in the report's functions property have been initialized.  One way to initialize the function variables in code would be to use the BeforePrint event of the TitleBand.  If your report does not require a title band, set PrintBand to false in that event.
Example of setting an integer value at the start of the report:
procedure TfrmExpr.TitleBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
var
  aQREvElement: TQREvElement;
begin
  with QuickRep1.Functions do
  begin
    aQREvElement := GetConstant('test');

    if (aQREvElement <> nil) and (aQREvElement.Value(nil).Kind = resInt) then
    begin
      SetIntegerConstant(aQREvElement, 10);
    end;
  end;
end;

------------------
Q.  I get the error message "Undeclared identifier; 'TQREvaluator'" when I compile a report that worked with QuickReport 2
A.  We moved the expression classes to a new unit, qrexpr.  If you add this unit to your uses section, the report will compile again.
------------------
Q.  I have a simple project which has a quick report, no bands, just a few labels, memo boxes, and pictures.  It worked prior to my upgrade to a purchased version.  Now if I do a Preview, the screen is blank, no data, as well as if I do a print, nothing happens.
A.  QuickReport was designed to work with bands.  Placing controls directly on the band was a non-supported feature of the previous version.   Try adding a detail band (set it's height to 1) and then set the report's PrintIfEmpty property to true.  Your report should now work as it did with QuickReport 2.
------------------
Q.  Delphi4 doesn't find the class "TQREvElementFunction" and my project will not compile.
A.  Make sure the qrexpr unit is in the uses clause, that is where the TQREvElement structures are defined.
------------------
Q.  The following code does not compile after upgrading: ReportForm.ExportToFilter(TQRHTMLExportFilter.Create(AttachmentFile));
A.  The naming was changed.  The following code will work: ReportForm.ExportToFilter(TQRHTMLDocumentFilter.Create('c:\report.htm'));
------------------
Q.  Can we use some TQRGroup with a TQuickAbstractRep control ?
A.  Not really, the TQuickAbstractRep does not have a DataSet property or OnNeedData event.  The mechanism for checking the group expression does not exist and the band would be printed only once.
------------------
Q.  Where are the documentation, help files, examples, QREditor, etc?
A.  QuickReport 3 is still being finished up and the documentation and help files are still being updated.  We will release them, but our efforts are focused on finishing up the package.  The QREditor control will be in the release version of QuickReport 3 Pro.
------------------
Q.  What is the TQuickAbstractRep control?
A.  This is a descendant of the TCustomQuickRep base class that does not use the TDataset.  If your application does not use the BDe, this will shrink the code size.
------------------
Q.  Why do report event use TCustomQuickRep instead of TQuickRep?
A.  This is the base class that TQuickRep is descended from.  This change makes it easier to do variations QuickReport objects
------------------
Q.  What happened to OnGenerateToPrinter?
A.  This feature has not been finished yet and has been disabled until it has been fixed.
------------------
Q.  What is the TQRStringsBand control?
A.  This is a band with a items property that is a built in stringlist.  It's name will appear in the expression builder and can be assigned to a TQRExpr control.  At runtime, this band will print for each line in the items property.
------------------
Q.  How do you use the export filter controls?
A.  Just drop them on a form in your project and they will show in the previews.
------------------
Q.  What is the new 'LinkBand' property?
A.  This works like the LinkBand property in QuickReport 1.  The Band components have a LinkBand property which is used to make several bands stick together. The LinkBand property can be set connected to another Band and QuickReport will then make a page break if there is not enough space left on the page for both bands. The second band can in turn be linked to a third band, and so on.  It will not keep a series of bands together, like a group of detail bands.  We have a demo project for QuickReport 3, QR3LSD4.ZIP, that shows how to "link" a set of bands.
------------------
Q.  How can I display a text file ?
A.  QR3 has some new functions to make this an easy task.
#1 Create a report using the TQuickAbstractRep control instead of 
using the TQuickRep control.  The TQuickAbstractRep control does not 
use any data aware controls and can shrink the size of your executable 
if you are not using any data ware controls in your application.  You 
can use the TQuickRep control, you just don't need to use it.
#2 Add a TQRStringsBand to the report.  This is a band with a items 
property that is a built in stringlist.
#3 Add a TQRExpr control to the band.  Set the following properties
Autosize - False
AutoStretch - True
Expression - to the name of the band (like 'QRStringsBand1')
Width -  to the width of the band (can be done at runtime)
#4 Before calling Print or Preview, load the text file into the items 
property of the TQRStringsBand like this:
QRStringsBand1.Items.LoadFromFile(SomeFileName)
#5  Call the preview or print methods.
Q.  I get the error message "Invalid BLOB handle in record buffer" when I use a QRDBRichText component to display RTF data stored in a BLOB field in a MS SQL Server 7 database.  What is causing this?
A.  That is a BDE error message, it does not come from QuickReport.  You are getting it with the QRDBRichText because you are using that control with BLOB data.  You may want to search the Delphi newsgroups, this appears to be a common problem.  Please see the BDE Administrator help file for the "BLOBS TO CACHE" setting, adjusting that value may help.
------------------
Q.  How can I edit the RTF data in a TQRDBRichText control before it prints?
A.  You would need to put the load data into a TRichEdit and edit the data there.  You would link the TRichEdit component to a TQRRichText component by setting the TQRRichText's ParentRichEdit property to the TRichEdit.
------------------
Q.  How can I copy the text from a TRichEdit component to the QuickReport RichText component?
A.  You would use the lines property to copy the data.  Example: QRRichText1.Lines := frm.RichEdit1.Lines;
------------------
Q.  I get an access violation when I have QRDBRichText on a subquery
A.  This is a recently discovered problem that happens with TQuery's 
that do not have persistent fields.  Adding persistent fields will fix 
this.  If you can not do this, insert a line into the 
TQRDBRichText.Print method in qrctrls.pas like the following example 

procedure TQRDBRichText.Print(OfsX, OfsY : integer);
begin
  Field := FDataSet.FindField(FDataField);  { Add this line }
  if assigned(Field) then
    if (Field is TMemoField) or
       (Field is TBlobField) then
      Lines.Assign(Field);
  inherited Print(OfsX,OfsY);
end;
------------------
Q.  My RTF field will not span more than one page
A.  There are some serious bugs in Microsoft's implementation of their RichText common control.  We are implementing work arounds to resolve as many of these issues as we can.  At this time we are still working on RTF fields that span more than one page.
------------------
Q.  My RTF field doesn't consistently print out the last line in the memo.
A.  This is known problem with the MS RichText common control.  There are two works arounds.  One is to add an extra blank line to the text, the other is to set the OnGenerateToPrint event of the report's qrprinter object to nil.  This will force the report to not render the report a second time.
Example:
procedure Tfrmqr.QuickRep1BeforePrint(Sender: TQuickRep; var PrintReport: boolean);
begin
  QuickRep1.qrprinter.OnGenerateToPrinter := nil;
end;
------------------
Q.  Can I print a richtext object that is in a field of a file with ole2 bmp object inserted in it?
Q.  My QRRichText control is ignoring the "\page" page break command.
A.  I'm sorry, but the TRichEdit control that the QRRichText and QRDBRichtext controls link to is limited to text only and it does not appear to support this feature.  Our controls are limited to the functionality of Borland's RichEdit control, which is a  wrapper for Microsoft's RTF control.   The MS RTF common control only supports a subset of the RTF control codes.  To see what sequences are supported, load your RTF text into WordPad.  WordPad uses the same common control and if it doesn't support an RTF control sequence, then it wont work on Delphi.
------------------
Q.  My QRDBRichText control is not resizing correctly.
A.  If the design time height of a QRDBRichText control is greater than some of the fields, it may not resize correctly.  If you set the height to a small value like 10 and set autostretch to true, it should work.
------------------
Q.  My QRRichText/QRDBRichText will not display or print embedded bitmaps.
A.  The TRichEdit and TDBRichEdit controls do not support embedded objects and since our RTF controls use the Borland RTF controls, we have the same limitation.
------------------

[Saved Reports (*.QRP)]
==================
Q.  I am using the QRPrinter object and I can't get it to save to a text
A.  Saving as text uses the ASCII export filter and the export filters 
only work with reports.  When you use the qrprinter object directly, 
the only save option is the default .QRP save.
------------------
Q.  How do I load a previously saved report via code?
A.  We have a class, TQRPHandler, that is defined and documented in 
the QRExtra unit.  This class is designed to easily allow you load a 
saved report using the following syntax:

Delphi:
  with TQRPHandler.Create do
  try
    Filename := 'somefile.QRP';
    Preview; {or}
    print;
  finally
    Free;
  end;

C++:
  fQRPHandler = new TQRPHandler;
  // Set it's filename property to one selected by the user
  fQRPHandler->Filename = OpenQRPDialog->FileName;

  fQRPHandler->Print();
  // or
  fQRPHandler->Preview();

  fQRPHandler->Free();
  fQRPHandler = NULL;


Q.  What is the format of a report saved to disk by clicking the save button in the previewer?
A.  The saved report format is a proprietary metafile format that is only readable by QuickReport.
------------------
Q.  Why can't I load reports saved from the preview into the Editor and vice versa?
A.  The .QRP files saved by the preview are a rendered copy of the report saved as a metafile (not WMF format).  You can only preview or print a .QRP file.  The .QR file saved by the Editor is a Delphi resource file like a .DFM file and is basically a report form.  It contains the information required to run a report, but it does not have any data from the report in it,
------------------
Q.  I am trying to do is distribute .qrp files to our sales force.  On
A.  You can, but if the page sizes are different the page will be 
stretched (or compressed) to fit the page and there may some loss in 
resolution.  An alternative way of doing this would be to use the PDF 
export filter to make PDF files.
Q.  We need a method of setting default charset East-European for all controls placed in Quick Report's reports
A.  Set the report's Font.Charset property to the character set that you want to use and make sure that the ParentFont property of all the bands are set to true before placing controls on the bands.  This will work for any font property and you can then change the control's font properties afterwards.
------------------
Q.  I wish to print mailing labels. But sometimes I have only one label to print. But print starts every time with the top left label. How can I say, that print starts with the second label or in the second column with the 4th label
A.  There are a few ways of dong this.  You could use the OnNeedData event to drive the report and code it to print X blank detail records until it reaches the label that you want start with.  You could also use a temporary table and write X number of blank records to the start of the file.  You could also add child bands to the title band and increase their size to eat up the space required to fit the columns.
------------------
Q.  When I increase a component's font size, the component's height increases.  When I set the font size to a smaller value, the component does not shrink the height.  Why does it do that and how can I make the component shrink in height?
A,  We trap the CM_FONTCHANGED message for TQRCustomLabel components.  When you change the font property, that message calls the CMFontChanged procedure.  This procedure tells the component to reformat the text and resize the height of the control of needed.  When you go from a larger font size to a smaller size, the height will not change.  To force the component to match the font size, you would need to set the height to 0 before changing the font size.
------------------
Q.  Why doesn't the OnPrint event work for memo fields with the TQRDBText component?
A.  Memo fields do not use the OnPrint event.  The reason behind the OnPrint event was to be able to override short text fields, like to expand an abbreviation.  If you really want to override a memo field, you could use a calculated field and handle that type of code in the OnCalcField event.
------------------
Q.  How do I force the text components to clip by letter instead of by word?
A.  The current code clips on word boundaries.  If you have a single line of text and you want to control the clipping by the letter, you can use the OnPrint event of the text component to manually clip the text.  The following example event can be used as a generic handler for multiple text components on a report:
procedure TfrmReport.QRLabel4Print(sender: TObject; var Value: String);
begin
  with TQRCustomLabel(Sender) do
    while (ParentReport.TextWidth(Font, Value) > Width) and (Value <> '') do
      Delete(Value, length(Value), 1);
end;
------------------
Q.  The OnPrint event for the TQRDBText component does not get called when the data is null.
A.  This is a limitation of the TQRDBText component.  The work around is to use a TQRExpr component and in it's OnPrint event, check the IsNull property of the dataset field.
------------------
Q.  My multi line text control only prints as a single line and it goes right off the right margin.
A.  Make sure that you have autosize set to false and AutoStretch set to true and WordWrap set to true.
------------------
Q.  The OnPrint event of my TQRLabel control is never being called.
A.  Is the caption of the label blank?  The code checks the caption and if it's blank, it doesn't call the OnPrint event to save time.  If you want to use OnPrint with a TQRLabel, you must set the Caption to a non empty string.
------------------
Q.  I have controls on the page footer that use the detail table.  On the each page of a report (except for the last page) the first record's data appears everywhere except in the page footer where the second record's data appears.
A.  When the page footer band is printed, the report is already working on the first detail record for the next page.  One way around this would be to use the AfterPrint event of the detail band to store the data for the page footer band in some variables.  In the BeforePrint event of the footerband, you would use TQRLabels and set the their captions to the string representations of the variables.
------------------
Q.  On a band, I have some QRDBText fields and a QRMemo field (set to autostretch=true).  When the memo field is going to go beyond the current page - QR prints the memo first (instead of the text fields) and then rolls on to the new page, finishes the memo, and then prints the text fields on top of the next page.  How can I force the QRDBText fields to print first?.
A.  The memo control is being printed first, which causes the page break and the rest of the controls are printed afterwards.  If you change the creation order of the controls on the band so that the memo is last, the other controls will print first.  Select each control (except for the Memo) and right-click on each one and select "Send to Back".  That will create other controls before memo.
------------------
Q.  I can't get my text to word wrap if it doesn't have any carriage returns in the text?
A.  Check to make sure that your text has spaces in it.  If the text is unbroken, it will not be word wrapped.
------------------
Q.  My RTF text does not have the same formatting as it appears in MS Word.
A.  QuickReport's RichText control uses Delphi's RichEdit control, which in turn is a wrapper for Microsoft's RichEdit common control.  And that control may not be able to handle your file.  Almost all of our RTF problems have been traced to bugs in that common control, and it ripples down to our control.  If you load your rtf file into WordPad and it looses the formatting, then you can trace it to the common control.
------------------
Q.  I can't get the mask property work with my phone number field (it's a string field)
A.  The mask property only applies to numeric fields and will be ignored on string data.  Use the OnPrint event to format the field like the following:
procedure TfrmReport.QRDBTextPhonePrint(sender: TObject; var Value: string);
begin
  Value := '(' + copy(Value,1,3) + ') ' + copy(Value,4,3)
    + '-' + copy(Value,7,4);
end;
------------------
Q.  If the report contains nulls or blanks these are not included, this destroys the alignment of the columns. Is there any way to include all nulls?
A.  Use a QRExpr control for fields that could have nulls and for the expression use the IF() function to insert a space for null fields like the following:
IF(tbSample.Extra<>'', tbSample.Extra, ' ')
------------------
Q.  My multiple line QRDBText controls are having the words cutoff at the right margin even when autosize is set to false.
A.  If you have autostretch turned on, please make sure that the WordWrap is also turned on.
------------------
Q.  I can't get the mask property to work on my numbers.
A.  Please make sure that you are using a number field, the mask property will be ignored for string fields.
------------------
Q.  I read the FAQ to use TQRDBText because there is no TQRDBMemo, but when my memo contains embedded carriage returns they show up as a square symbol, not as a new line.
A.  This was a known bug and it was fixed in the 2.0j release.
------------------
Q.  Is there a property for QRDBText to tell it *not* to split itself across pages? (i.e. widow/orphan protection.)
A.  We do not have support for a Window/orphan feature, but you can do this with some minor code.
There is a function in the report called AvailableSpace that returns the amount of space left on the page.  You can compare that value to the band's Size.Length property and call NewPage when There is not enough space for the band.  AvailableSpace is a protected function so you can not call it directly.  If you subclass the report, you can access the function by casting the report to the subclass.
First, add the following declaration in the type section of your report form declaration:
  TMyQuickRep = class(TQuickRep)
  end;

To use this function to keep a band from being split over a page:
procedure Tfrm.DetailBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
  if TMyQuickRep(QuickRep1).AvailableSpace >= round(Sender.Size.Length) then
    Sender.ParentReport.NewColumn;
end;
------------------
Q.  How do I control interline spacing within a QRMemo?  Sometimes I need greater control over the line spacing.
A.  We do not support this.  This is being considered for a future release, but it has not been scheduled yet.
------------------
Q.  When a TQRDBText field is added to a pageheader band the field is not refreshed (it remains the last field printed).
A.  This is not a bug, the report is designed to retrieve rows from the dataset when it handles the detail band, it's not designed to refresh the dataset at the first call for the PageHeader.  There is a simple way to get the correct for what you want to do.  In the BeforePrint event of the report, add a line that goes to the first row of the dataset.  If you are using a TTable named "Table1" it would look like this:
procedure TfrmSample.QuickRep1BeforePrint(Sender: TQuickRep;
  var PrintReport: Boolean);
begin
  Table1.First;
end;
------------------
Q.  I put a mask 999\-999\-9999 for a phone number. And it still printing 5144559400 instead of 514-455-9400. Why?
A.  That is the format of the editmask used by the TMaskedEdit control. The QRExpr control's mask is the format string used by FormatFloat() and FormatDateTime functions.  Please refer to their documentation for allowable values.  In this case, the format mask for the USA phone number would '(000) 000-000'
Documented on page 2-32 in the manual.
------------------
Q.  I have two autostretched text controls on one band and it doesn't work right.
A.  Multiple stretching controls on one band is not supported.  This is documented on the manual page for the AutoStretch property.  This limitation was removed in the 3.0 release.
------------------
Q.  I have a calculated table field and it has line breaks in the text and those line breaks don't print.
A.  Delphi defines calculated table text fields as TStringfield and QR handles that type of field differently than it handles actual memo fields.  To output a calculated text field, use a QRMemo component and set QRMemo.Lines.Text to the value of the calculated field at runtime.
------------------
Q.  I am setting QuickRep1.QRPrinter.OnGenerateToPrinter:=nil to expedite the printing of a large report from the preview form.  When I use the printersetup to select a subset of the pages for printing, I still get all of the pages printed. When I don't set OnGenerateToPrinter:=nil, the settings take effect and I get the subset of pages printed. How can I print a subset of the pages and still use OnGenerateToPrinter:=nil to expedite printing?
A.  This is a known limitation (also applies to saved reports) and will be addressed in a future release.  The only work around would be to only set the OnGenerateToPrinter to nil when you know that the printer setup button has not been pressed.  Starting with the 2.0j release, if you use a custom preview, you can check the result of calling printersetup and then you could set the OnGenerateToPrinter to nil if the user did not use printersetup.
------------------
Q.  Is there a simple way to use a single QRLabel and create a label with the letters stacked on top of each other.  An example is shown below.
P
A
T
I
E
N
T
A.  With QR 2.0J you can insert carriage returns and line feeds between each letter and set the Stretch property of the control to true.
Example:
qrlabel1.Caption :=   'V' + #13#10 + 'E' + #13#10 + 'R' + #13#10 + 'T' + #13#10 + 'I' + #13#10 + 'C' + #13#10 + 'A' + #13#10 + 'L';
------------------
Q.  I need to change the DataField properties on the QRDBText component under run-time so that it uses one field on page 1 and another the rest of the pages.
A.  You can not change the DataField property after the report starts.  You could use a TQRLabel control and set it's value at runtime in (either in it's OnPrint event or it's parent band's BeforePrint event) based on the current value of the report's PageNumber property.
------------------
Q.  If I use tabs (ctrl-tab in the editor) in my TQrMemo fields the report prints []. Is that a general problem in TQrMemo fields?
A.  Tab characters are not supported in the TQRMemo, TQRLabel, TQRExpr, TQRDBtext controls.  The only control that will correctly display a tab character are the RichText controls.
------------------
Q.  Is it possible to change the Autosize property of the QRImage and the Autostretch property of the QRRichtext at runtime ?
A.  Yes, you can change most of the properties at runtime in the BeforePrint and AfterPrint events of the report and of the band that the controls are on.
------------------
Q.  Can you advise me how to suppress the printing of blank fields in mailing label report?
A.  Use a TQRMemo control and fill it with only the information that is not blank.
Example:

procedure TReportForm.AddIfNotBlank(memo: TQRMemo; s: string);
begin
  { simple function to only add non blank fields }
  if Trim(s) <> '' then memo.Lines.Add(s);
end;

procedure TReportForm.DetailBand1BeforePrint(Sender: TQRCustomBand; var PrintBand: Boolean);
begin
  QRMemo1.Lines.Clear;
  QRMemo1.Lines.Add(Table1Company.AsString);

  AddIfNotBlank(QRMemo1, Table1Addr1.AsString);
  AddIfNotBlank(QRMemo1, Table1Addr2.AsString);
  AddIfNotBlank(QRMemo1, Table1City.AsString + ', ' +  Table1State.AsString + '  ' + Table1Zip.AsString);
end;
------------------
Q. What are printer setup events ?
A. Two new events 'OnApplyPrinterSettings' and 'OnGetPrinterSettings' have been added to TCustomQuickrep. These events expose the DeviceMode structure and allow the user to amend values or cancel the operation.

The code snippets below are examples of the events implemented-


//OnGetPrintersettings is fired twice - first BEFORE the printer
//values are placed in the DevMode ( the user can cancel this ), and 
//a second time AFTER the printer values are placed in DevMode. This 
//allows the values to be interrogated.

procedure TRepForm.QuickRep1GetPrinterSettings(Sender: TObject; var Cancel: Boolean; DevMode: Pointer);
begin
      // cancels the GetPrinterSettings - the printer settings are 
      // NOT written into the PrinterSettings structure

      cancel := true;
end;



// OnApplyPrinterSettings is fired once, after the design values have 
// been placed in DevMode, but before the DevMode is given to the 
// printer. The user may change values in DevMode or cancel the 
// operation.
procedure TRepForm.QuickRep1ApplyPrinterSettings(Sender: TObject;
  var Cancel: Boolean; DevMode: Pointer);
var
   cdevmode : PDeviceMode;// not necessary but used for explicitness
begin
     // this code is not concise but pedagogical

     // forces the printer to do 2 copies( assuming it is supported)
     cdevmode := PDeviceMode( DevMode);
     cdevmode.dmCopies := 2;
end;


for details of the DevMode structure see 'vcl\source\printers.pas' and the Win32 API help.

Q. QR3.6 and later printer setup options
A. These are properties of TQuickrep and may be set at design or run-time.

UseStandardPrinter

disables QR's internal printer setup and allows the standard Delphi printer setup to be used. Default is 'False'.

UseCustomBinCode

overrides the internal output bin selection codes. Default is 'False'. This option also forces an over-ride of what the user selects in the printer setup dialog. If this option is set along with an actual code ( CustomBinCode property) , then the user selection is ignored and the custom code is used. If you want the user to select the bin at run-time, don't use this option, but try the UseStandardPrinter' over-ride instead. This remark also applies to the 'UseCustomPaperCode' option.

CustomBinCode

the integer value that will be sent to the printer for bin selection

UseCustomPaperCode

overrides the internal paper selection codes. Default is 'False'. See above 'UseCustomBinCode' also. If this option is set, then the PaperWidth and PaperHeight values set at design time will over-ride anything the user sets up in the printer setup.

CustomPaperCode

the integer value that will be sent to the printer for paper selection. Also the paper dimensions, see above.

ExtendedDuplex 

is of integer type, allowing a wide range of codes to be used. The recognised Delphi constants only have 3 values, which will soon need extension, so this property has been left open. It is your responsibility now to ensure that a proper code is used. Any value other than 0 (ZERO) will override the Duplex setting.

The values defined in the Delphi VCL (windows.pas) are - 

  { duplex enable }
  {$EXTERNALSYM DMDUP_SIMPLEX}
  DMDUP_SIMPLEX = 1;
  {$EXTERNALSYM DMDUP_VERTICAL}
  DMDUP_VERTICAL = 2;
  {$EXTERNALSYM DMDUP_HORIZONTAL}
  DMDUP_HORIZONTAL = 3;

Q. How can the initial size of the preview be controlled ?
A. There are properties of TQuickrep that can be set at design or run-time to control the appearance of 
the preview window.

PreviewInitialState : TWindowState.

wsMinimized

wsMaximized

wsNormal

PreviewFormStyle : TFormStyle

fsStayOnTop

fsNormal

PreviewWidth : integer;

if this is set to 0 the default value of 500 is used.

Preview Height : integer;

if this is set to 0 the default value of 500 is used.
--------------------------------------------------------------------------
Q. What is the abstract table ?
A. This is a dataset that lets you define its fields manually. When it requires data for a field an event
is called allowing data from any source to be fed into the report, as if it were coming from a database
table.

There is a sample app available at www.quickreport.co.uk in the FAQ section.
---------------------------------------------------------------------------

Q. How do I get the Expanded height of bands and controls
A. Bands have a method called ExpandedHeight which takes a single var argument
which returns the expanded height of the bad.

Controls have a method called GetExpandedHeight which takes a similar arg.


Delphi examples
---------------


procedure Trepform.DetailBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
begin
    // get the height of the memo
    qrmemo1.GetExpandedHeight(ht);
    // assign new height to shape
    self.QRShape1.Size.Height := th;
    // do this if you want to stop the band breaking over a page
    if quickrep1.AvailableSpace < th then
          quickrep1.NewColumn;
end;

procedure Trepform.QRChildBand1BeforePrint(Sender: TQRCustomBand;
  var PrintBand: Boolean);
var
  cbh : extended;
begin
      // getting the height of the band
      QRChildBand1.ExpandedHeight( cbh);
      if cbh > 100 then
         printband := false;
end;

C++ Samples
-----------

    // get the height of the memo
    qrmemo1->GetExpandedHeight(ht);
    // assign new height to shape
    self->QRShape1->Size.Height = th;
    // do this if you want to stop the band breaking over a page
    if (quickrep1.AvailableSpace < th )
          quickrep1->NewColumn();
          
          
      // getting the height of the band
      QRChildBand1->ExpandedHeight( cbh);
      if (cbh > 100)
         printband = false;
 
-----------------------------------------------------------------------------
Q. How can I send printer control codes ( escape codes ) ?
A. This note shows how to use the Escape API function.

You can send these codes when the report has started from the beforePrint event
of a band, for instance.

procedure SendPclCode(Report: TCustomQuickRep; ToCommand: integer; ToSend:
  string);
type
  TPrnBuffRec = record
    BuffLength: Word;
    Buffer: array[0..255] of Char;
  end;
var
  Buff: TPrnBuffRec;

  function CheckPrinter: boolean;
  var
    TestInt: integer;
  begin
     { Test to see if the "PASSTHROUGH" escape is supported }
    TestInt := PASSTHROUGH;
    Result := (Escape(Report.QRPrinter.Canvas.Handle, QUERYESCSUPPORT,
      sizeof(TestInt), @TestInt, nil) > 0);
  end;

begin
   {If Api is unsupported, then exit}
  if not CheckPrinter then
    Exit;
  if (ToCommand = 27) then
  begin
    StrPCopy(Buff.Buffer, #27 + ToSend);
  end
  else if (ToCommand = 26) then
  begin
    StrPCopy(Buff.Buffer, #26 + ToSend + #25);
  end
  else if (ToCommand = 20) then
  begin
    StrPCopy(Buff.Buffer, #20 + ToSend + #20);
  end
  else
  begin
    StrPCopy(Buff.Buffer, ToSend);
  end;

   { Set the buffer length }
  Buff.BuffLength := StrLen(Buff.Buffer);
   { Make the escape}
  Escape(Report.QRPrinter.Canvas.Handle,
    PASSTHROUGH,
    0,
    @Buff,
    nil);
end;

--------------------------------------------------------------------------
Q.  How can I control the preview Controlling the preview AFTER it is created and displayed ?
A.  It is possible to do this -

Controlling a preview using a timer.

This code snippet shows how the preview form may be controlled
using a timer to to fire API calls that can re-size, or minimise and
maximise a showing preview.
The zoom state and other properties may also be set

The app has 2 forms, Mainform and RepForm
which has a quickrep called QuickRep1.

The code is rather bare - but the principles are illustrated.
The most amazing thing is that this -

repform.QuickRep1.QRPrinter.Client.Parent.Handle

is the handle of the preview window.

{-----------------------------------------------------
  This button on the main form kicks-off the preview
  and sets the timer on mainform.
  Set the interval of the timer to 50000 in design mode.
-----------------------------------------------------}
procedure TMainform.SpeedButton1Click(Sender: TObject);
begin
     timer1.enabled := false;
     repform.Table1.open;
     // this can be as small as you like - provided the
     // tick routine checks that the preview is showing
     timer1.Interval := 3000; // millisecs
     timer1.enabled := true;
     repform.QuickRep1.Preview;
     repform.Table1.close;
end;

{---------------------------------------------------
 Reposition and/or resize the window. See WinAPI help
 for the possibilities of the SetWindowPlacement call.
----------------------------------------------------}
procedure Tmainform.Timer1Timer(Sender: TObject);
var
   pStru : WINDOWPLACEMENT;
begin
     // here we should check if the preview is showing
     // and exit if not. A delay of 1 or 2 seconds is
     // enough usually to allow this.
     // This test might fail - but it hasn't yet
     if not assigned(repform.QuickRep1.QRPrinter) then exit;

     timer1.enabled := false; // we've finished with the timer.

     // Doing it the easy way. Resetting the WindowState may not be
     // necessary.
     TForm( repform.QuickRep1.QRPrinter.Client.parent).WindowState := wsNormal;
     repform.QuickRep1.QRPrinter.Client.parent.width := 800;
     repform.QuickRep1.QRPrinter.Client.parent.height := 600;
     repform.QuickRep1.QRPrinter.Client.parent.top := 50;
     repform.QuickRep1.QRPrinter.Client.parent.left := 50;
     exit;

     // How to do it with API calls. This way is smoother.
     // set the Window position structure
     pstru.length := sizeof( WINDOWPLACEMENT);// mandatory
     pstru.showCmd := SW_RESTORE; // could be SW_SHOWMAXIMIZED etc.
     pstru.flags := WPF_SETMINPOSITION;
     // set the rect in screen pixels for a move/resize
     pstru.rcNormalPosition := rect( 100, 100, 850, 700 );
     SetWindowPlacement( repform.QuickRep1.QRPrinter.Client.parent.Handle, @pstru );
end;


Setting the toolbar buttons
---------------------------
Use a longer time delay to do this - because the buttons
are reset in the QR code when the report is done.

This code may be put in the AfterPrint event of the report and the timer given
a short interval.

// add some vars in the proc above
var
   prevFrm : TForm;
   tBar, tBut, tPrev : TComponent;
..
..
     // this code goes into the proc above
     // find the buttons and set them
     prevfrm := TForm( repform.QuickRep1.QRPrinter.Client.parent);
     for j := 0 to prevfrm.controlcount-1 do
     begin
         tBar := prevfrm.controls[ j ];
         if tBar is TToolbar then
         begin
             // Vanish the toolbar !!
             // TToolbar(tBar).visible := false;
             // break; // if vanishing
             for k := 0 to TToolbar(tBar).controlcount-1 do
             begin
                tBut := TToolbar(tBar).controls[ k ];
                if tBut is TToolbutton then  // could test the name here
                    TToolbutton(tBut).enabled := false;
             end;
         end;
     end;



Setting the preview component properties.
----------------------------------------
     // insert into the procedure above

     // set preview component
     tPrev := repform.QuickRep1.QRPrinter.Client;
     TQRPreview(tPrev).ZoomToWidth;
     TQRPreview(tPrev).Zoom := 80;
     TQRPreview(tPrev).color := clRed;


-----------------------------------------------------------------------------
Q.  How can I change page size in concatenated PDF exports
A. You can send many reports into the same PDF document using the Concatenate feature
of the filter. The page size may be changed between reports like this.

QR3
In file QRPDFFilt.pas, find this declaration and copy it to your app.

   Procedure SetPageParams( w, h, tm, tma, lma : extended ); external 'QRPdfLib.dll';
   
QR5
   use the method SetPageParams( w, h, tm, tma, lma : extended ) of the filter object.
   
In between the calls to ExportToFilter, this procedure should be called to
set the page height and width ( in points 72 points = 1 inch).

    tm := quickrep1.page.TopMargin * 0.1 * PointsPerMM;
    SetPageParams( 0.1*PaperWidth*PointsPerMM, 0.1*paperheight*PointsPerMM, tm, TopMargin, Leftmargin );
    quickrep1.ExportToFilter(....);
    
    tm := quickrep2.page.TopMargin * 0.1 * PointsPerMM;
    SetPageParams( 0.1*PaperWidth*PointsPerMM, 0.1*paperheight*PointsPerMM, tm, TopMargin, Leftmargin );
    quickrep2.ExportToFilter(....);
    
    

